"use strict";const $=new Set,l=new WeakMap,v=new WeakMap,h=new WeakMap,T=new WeakMap,S=new WeakMap,j=new WeakMap,b=new WeakMap,M=new WeakMap,x=new WeakSet;let w,A=0,B=0;const m="__aa_tgt",O="__aa_del",k="__aa_new",z=e=>{const t=Z(e);t&&t.forEach(n=>ee(n))},G=e=>{e.forEach(t=>{t.target===w&&K(),l.has(t.target)&&E(t.target)})};function J(e){T.get(e)?.disconnect();let n=l.get(e),o=0;const i=5;n||(n=W(e),l.set(e,n));const{offsetWidth:a,offsetHeight:s}=w,r=[n.top-i,a-(n.left+i+n.width),s-(n.top+i+n.height),n.left-i].map(d=>`${-1*Math.floor(d)}px`).join(" "),c=new IntersectionObserver(()=>{++o>1&&E(e)},{root:w,threshold:1,rootMargin:r});c.observe(e),T.set(e,c)}function E(e){clearTimeout(M.get(e));const t=C(e),n=N(t)?500:t.duration;M.set(e,setTimeout(async()=>{const o=h.get(e);try{await o?.finished,l.set(e,W(e)),J(e)}catch{}},n))}function K(){clearTimeout(M.get(w)),M.set(w,setTimeout(()=>{$.forEach(e=>H(e,t=>q(()=>E(t))))},100))}function Q(e){setTimeout(()=>{j.set(e,setInterval(()=>q(E.bind(null,e)),2e3))},Math.round(2e3*Math.random()))}function q(e){typeof requestIdleCallback=="function"?requestIdleCallback(()=>e()):requestAnimationFrame(()=>e())}let L;const X=typeof window<"u"&&"ResizeObserver"in window;X&&(w=document.documentElement,new MutationObserver(z),L=new ResizeObserver(G),window.addEventListener("scroll",()=>{B=window.scrollY,A=window.scrollX}),L.observe(w));function Z(e){return e.reduce((t,n)=>[...t,...Array.from(n.addedNodes),...Array.from(n.removedNodes)],[]).every(t=>t.nodeName==="#comment")?!1:e.reduce((t,n)=>{if(t===!1)return!1;if(n.target instanceof Element){if(_(n.target),!t.has(n.target)){t.add(n.target);for(let o=0;o<n.target.children.length;o++){const i=n.target.children.item(o);if(i){if(O in i)return!1;_(n.target,i),t.add(i)}}}if(n.removedNodes.length)for(let o=0;o<n.removedNodes.length;o++){const i=n.removedNodes[o];if(O in i)return!1;i instanceof Element&&(t.add(i),_(n.target,i),v.set(i,[n.previousSibling,n.nextSibling]))}}return t},new Set)}function _(e,t){!t&&!(m in e)?Object.defineProperty(e,m,{value:e}):t&&!(m in t)&&Object.defineProperty(t,m,{value:e})}function ee(e){var t;const n=e.isConnected,o=l.has(e);n&&v.has(e)&&v.delete(e),h.has(e)&&((t=h.get(e))===null||t===void 0||t.cancel()),k in e?U(e):o&&n?ne(e):o&&!n?oe(e):U(e)}function u(e){return Number(e.replace(/[^0-9.\-]/g,""))}function te(e){let t=e.parentElement;for(;t;){if(t.scrollLeft||t.scrollTop)return{x:t.scrollLeft,y:t.scrollTop};t=t.parentElement}return{x:0,y:0}}function W(e){const t=e.getBoundingClientRect(),{x:n,y:o}=te(e);return{top:t.top+o,left:t.left+n,width:t.width,height:t.height}}function Y(e,t,n){let o=t.width,i=t.height,a=n.width,s=n.height;const r=getComputedStyle(e);if(r.getPropertyValue("box-sizing")==="content-box"){const c=u(r.paddingTop)+u(r.paddingBottom)+u(r.borderTopWidth)+u(r.borderBottomWidth),d=u(r.paddingLeft)+u(r.paddingRight)+u(r.borderRightWidth)+u(r.borderLeftWidth);o-=d,a-=d,i-=c,s-=c}return[o,a,i,s].map(Math.round)}function C(e){return m in e&&b.has(e[m])?b.get(e[m]):{duration:250,easing:"ease-in-out"}}function F(e){if(m in e)return e[m]}function R(e){const t=F(e);return t?x.has(t):!1}function H(e,...t){t.forEach(n=>n(e,b.has(e)));for(let n=0;n<e.children.length;n++){const o=e.children.item(n);o&&t.forEach(i=>i(o,b.has(o)))}}function I(e){return Array.isArray(e)?e:[e]}function N(e){return typeof e=="function"}function ne(e){const t=l.get(e),n=W(e);if(!R(e))return l.set(e,n);let o;if(!t)return;const i=C(e);if(typeof i!="function"){const a=t.left-n.left,s=t.top-n.top,[r,c,d,p]=Y(e,t,n),g={transform:`translate(${a}px, ${s}px)`},f={transform:"translate(0, 0)"};r!==c&&(g.width=`${r}px`,f.width=`${c}px`),d!==p&&(g.height=`${d}px`,f.height=`${p}px`),o=e.animate([g,f],{duration:i.duration,easing:i.easing})}else{const[a]=I(i(e,"remain",t,n));o=new Animation(a),o.play()}h.set(e,o),l.set(e,n),o.addEventListener("finish",()=>E(e),{once:!0})}function U(e){k in e&&delete e[k];const t=W(e);l.set(e,t);const n=C(e);if(!R(e))return;let o;if(typeof n!="function")o=e.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:n.duration*1.5,easing:"ease-in"});else{const[i]=I(n(e,"add",t));o=new Animation(i),o.play()}h.set(e,o),o.addEventListener("finish",()=>E(e),{once:!0})}function V(e,t){var n;e.remove(),l.delete(e),v.delete(e),h.delete(e),(n=T.get(e))===null||n===void 0||n.disconnect(),setTimeout(()=>{if(O in e&&delete e[O],Object.defineProperty(e,k,{value:!0,configurable:!0}),t&&e instanceof HTMLElement)for(const o in t)e.style[o]=""},0)}function oe(e){var t;if(!v.has(e)||!l.has(e))return;const[n,o]=v.get(e);Object.defineProperty(e,O,{value:!0,configurable:!0});const i=window.scrollX,a=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(e,o):n&&n.parentNode?n.parentNode.appendChild(e):(t=F(e))===null||t===void 0||t.appendChild(e),!R(e))return V(e);const[s,r,c,d]=re(e),p=C(e),g=l.get(e);(i!==A||a!==B)&&ie(e,i,a,p);let f,y={position:"absolute",top:`${s}px`,left:`${r}px`,width:`${c}px`,height:`${d}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!N(p))Object.assign(e.style,y),f=e.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:p.duration,easing:"ease-out"});else{const[D,P]=I(p(e,"remove",g));P?.styleReset!==!1&&(y=P?.styleReset||y,Object.assign(e.style,y)),f=new Animation(D),f.play()}h.set(e,f),f.addEventListener("finish",()=>V(e,y),{once:!0})}function ie(e,t,n,o){const i=A-t,a=B-n,s=document.documentElement.style.scrollBehavior;if(getComputedStyle(w).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+i,window.scrollY+a),!e.parentElement)return;const r=e.parentElement;let c=r.clientHeight,d=r.clientWidth;const p=performance.now();function g(){requestAnimationFrame(()=>{if(!N(o)){const f=c-r.clientHeight,y=d-r.clientWidth;p+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-y,top:window.scrollY-f}),c=r.clientHeight,d=r.clientWidth,g()):document.documentElement.style.scrollBehavior=s}})}g()}function re(e){const t=l.get(e),[n,,o]=Y(e,t,W(e));let i=e.parentElement;for(;i&&(getComputedStyle(i).position==="static"||i instanceof HTMLBodyElement);)i=i.parentElement;i||(i=document.body);const a=getComputedStyle(i),s=l.get(i)||W(i),r=Math.round(t.top-s.top)-u(a.borderTopWidth),c=Math.round(t.left-s.left)-u(a.borderLeftWidth);return[r,c,n,o]}function ae(e,t={}){if(X&&L&&!(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!N(t)&&!t.disrespectUserMotionPreference)){x.add(e),getComputedStyle(e).position==="static"&&Object.assign(e.style,{position:"relative"}),H(e,E,Q,o=>L?.observe(o)),N(t)?b.set(e,t):b.set(e,{duration:250,easing:"ease-in-out",...t});const n=new MutationObserver(z);n.observe(e,{childList:!0}),S.set(e,n),$.add(e)}return Object.freeze({parent:e,enable:()=>{x.add(e)},disable:()=>{x.delete(e)},isEnabled:()=>x.has(e),destroy:()=>{x.delete(e),$.delete(e),b.delete(e),S.get(e)?.disconnect(),S.delete(e),H(e,o=>{L?.unobserve(o);const i=h.get(o);try{i?.cancel()}catch{}h.delete(o),T.get(o)?.disconnect(),T.delete(o);const s=j.get(o);s&&clearInterval(s),j.delete(o);const r=M.get(o);r&&clearTimeout(r),M.delete(o),l.delete(o),v.delete(o)})}})}export{ae as a};
