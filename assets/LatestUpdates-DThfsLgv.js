import{d as X,c as z,r as m,x as I,y as ss,a as l,o as i,f as p,k as v,b as s,b3 as es,h as u,Z as L,g as k,t as d,B as ts,F as S,H as j,j as as,e as h,P as os,a9 as ns,p as is}from"./main-B6p-vdzd.js";import{_ as ls}from"./logo-white-CwkOOWqZ.js";import{s as A}from"./index-BWzmTX62.js";import{s as rs}from"./index-J0pzViuh.js";import{s as cs}from"./index-B4YVmC16.js";import{s as ds}from"./index-Cb25hxL1.js";import{g as ps}from"./api-Bbdr4r4D.js";import"./index-DWFeWuc4.js";const us={class:"space-page-container"},ms={class:"flex items-start justify-between mb-6 header-container"},fs={class:"flex flex-col"},vs={class:"text-stellar-gray mt-2"},gs={class:"mb-4 flex items-center gap-2"},hs={class:"panel-content"},xs={class:"update-info"},_s={key:0,class:"loading-message"},bs={key:1,class:"error-message p-error"},ks={class:"p-4"},ys={class:"flex flex-column gap-3"},ws={class:"flex align-items-center gap-2"},$s={class:"update-title"},Cs={class:"flex justify-between items-center mb-3"},Ss={class:"update-date"},Us={class:"update-date-formatted"},Ns={key:0,class:"image-container"},Ds=["src","alt"],Ms={class:"update-details"},zs={class:"detail-item"},Ls={class:"detail-value"},js={key:0,class:"summary-box"},Ts={key:1,class:"fixes-box"},Vs={class:"fixes-preview"},Bs={class:"fix-text"},Rs={key:0,class:"fixes-actions"},Es={class:"dialog-content"},Fs={class:"fixes-count"},Is={class:"fixes-list-container"},As={class:"fix-number"},Ps={class:"fix-content"},Ws={class:"dialog-footer"},Hs={class:"mt-3 flex justify-between"},qs=["href"],Os=["href"],Ys=X({__name:"LatestUpdates",setup(Zs){const x=z(()=>M.value.slice(0,D.value)),o=m({}),U=m(!0),y=m(null),N=m(window.innerWidth),D=m(10),M=m([]),T=m(!1),w=m({}),P=z(()=>N.value<768?1:N.value<1200?2:3),V=async()=>{try{const a=new URLSearchParams({action:"parse",page:"Noticias",prop:"text",format:"json",origin:"*"}),c=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${a.toString()}`)).json()).parse.text["*"];W(c)}catch(a){y.value="Error al cargar las noticias",console.error(a)}},W=a=>{const e=new DOMParser,c=e.parseFromString(a,"text/html").querySelector(".plainlinks");if(!c)return;const n=[],r=c.innerHTML.split("<br>");for(const _ of r){if(!_.trim())continue;const b=e.parseFromString(_,"text/html"),g=b.querySelector("a");if(g){const $=g.textContent?.trim()||"",f=g.getAttribute("href")||"",C=decodeURIComponent(f.split("/wiki/").pop()||"").replace(/_/g," ").match(/(\d+\.\d+(\.\d+)?)/),F=b.body.textContent?.match(/(\d{1,2} de [a-z]+ de \d{4})/i);C&&F&&n.push({title:$,link:`https://nomanssky.fandom.com${f}`,date:F[1],version:C[1]})}}M.value=n,H()},H=async()=>{try{for(const a of x.value){const e=await q(a.link);e&&(o.value[a.version]=e)}}catch(a){console.error("Error fetching update details:",a)}finally{U.value=!1}},q=async a=>{try{const e=a.split("/wiki/")[1],t=new URLSearchParams({action:"parse",page:decodeURIComponent(e),prop:"wikitext",format:"json",origin:"*"}),r=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${t.toString()}`)).json()).parse.wikitext["*"];return Y(r,e)}catch(e){return console.error(`Error fetching details for ${a}:`,e),{}}},O=a=>(a=a.replace(/'''/g,""),a=a.replace(/''/g,""),a=a.replace(/\[\[([^\|\]]+)\|([^\]]+)\]\]/g,"$2"),a=a.replace(/\[\[([^\]]+)\]\]/g,"$1"),a=a.replace(/<br\s*\/?>/gi,`
`),a),Y=async(a,e)=>{const t={fixes:[]},c=a.match(/\|\s*image\s*=\s*(.+?)\n/);if(c){const $=c[1].split(`
`)[0].split("|")[0].trim(),f=await ps($);f&&(t.image=f)}const n=a.match(/\|\s*date\s*=\s*(.+?)\n/);n&&(t.date=n[1].trim());const r=a.match(/\|\s*platform\s*=\s*(.+?)\n/);r&&(t.platforms=r[1].trim());const _=a.match(/\|\s*link\s*=\s*\[(https?:\/\/[^\s\]]+)(?:\s[^\]]*)?\]/);_&&(t.link=_[1].trim());const b=a.match(/==\s*Resumen\s*==\s*\n([\s\S]*?)(?=\n==|$)/);b&&(t.summary=O(b[1].trim()));const g=a.match(/==\s*(?:corre(?:cci[oó]n(?:es)?\s+de\s+errores?|cciones\s+de\s+errores?)|notas?\s+del\s+parche)\s*==\s*\n([\s\S]*?)(?=\n==|$)/i);if(g){const f=g[1].matchAll(/\*\s*(.+?)(?=\n\*|\n$)/g);for(const E of f){const C=E[1].replace(/\s+/g," ").trim();t.fixes?.push(C)}}return t};I(()=>{window.addEventListener("resize",()=>N.value=window.innerWidth),V()});const Z=()=>{U.value=!0,y.value=null,M.value=[],o.value={},V()},B=a=>{const e={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12"},t=a.split(" de ");if(t.length===3){const c=t[0].padStart(2,"0"),n=e[t[1].toLowerCase()],r=t[2];return`${c}/${n}/${r}`}return a},G=z(()=>x.value.length>0?B(x.value[0].date):"N/A"),R=()=>{T.value=window.scrollY>300},J=()=>{window.scrollTo({top:0,behavior:"smooth"})};I(()=>{window.addEventListener("scroll",R)}),ss(()=>{window.removeEventListener("scroll",R)});const K=a=>{w.value[a]=!0},Q=a=>{w.value[a]=!1};return(a,e)=>(i(),l(S,null,[p(u(A),{class:"p-0 galactic-card"},{content:v(()=>[s("div",us,[s("div",ms,[s("div",fs,[e[1]||(e[1]=s("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[s("div",{class:"wiki-logo"},[s("img",{src:ls,class:"logo-image",alt:"Wiki Logo"})])],-1)),e[2]||(e[2]=s("div",{class:"header-container"},[s("div",{class:"title-theme-container"},[s("h1",{class:"galactic-title"},[s("span",{class:"title-text"},"Actualizaciones de No Man's Sky")])])],-1)),e[3]||(e[3]=s("p",{class:"text-stellar-gray mt-2"},"Últimas actualizaciones del juego desde la wiki oficial",-1)),s("p",vs,[p(es,{style:{"margin-right":"2rem"}})])])]),s("div",gs,[e[4]||(e[4]=s("label",{for:"maxUpdates",class:"text-stellar-gray font-semibold"},"Mostrar hasta:",-1)),p(u(ds),{id:"maxUpdates",modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value=t),min:1,max:15,showButtons:!0,inputClass:"p-inputtext-sm",class:"mx-2"},null,8,["modelValue"]),e[5]||(e[5]=s("span",{class:"text-stellar-gray"},"actualizaciones",-1)),e[6]||(e[6]=s("br",null,null,-1)),e[7]||(e[7]=s("br",null,null,-1)),p(u(L),{label:"Buscar Actualizaciones",icon:"pi pi-refresh",class:"p-button-outlined p-button-sm",onClick:Z})]),p(u(cs),{class:"galactic-panel"},{header:v(()=>[...e[8]||(e[8]=[s("h2",{class:"panel-title"},"Historial de Actualizaciones",-1)])]),default:v(()=>[s("div",hs,[s("p",null,[e[9]||(e[9]=k(" Total de actualizaciones recientes: ",-1)),s("strong",null,d(x.value.length),1)]),s("p",xs,"Última actualización: "+d(G.value),1)])]),_:1}),e[19]||(e[19]=s("br",null,null,-1)),U.value?(i(),l("div",_s,[...e[10]||(e[10]=[s("i",{class:"pi pi-spinner pi-spin"},null,-1),k(" Cargando actualizaciones... ",-1)])])):y.value?(i(),l("div",bs,[e[11]||(e[11]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),k(" "+d(y.value),1)])):(i(),l("div",{key:2,class:"grid gap-4",style:ts(`grid-template-columns: repeat(${P.value}, 1fr)`)},[(i(!0),l(S,null,j(x.value,(t,c)=>(i(),as(u(A),{key:c,class:"update-card"},{content:v(()=>[s("div",ks,[s("div",ys,[s("div",ws,[s("h3",$s,d(t.title),1),p(u(rs),{value:t.version,severity:"info",class:"version-tag"},null,8,["value"])]),s("div",Cs,[s("span",Ss,d(t.date),1),s("span",Us,d(B(t.date)),1)]),o.value[t.version]?.image?(i(),l("div",Ns,[s("img",{src:o.value[t.version]?.image?.panel,alt:t.title,class:"update-image"},null,8,Ds)])):h("",!0),s("div",Ms,[s("div",zs,[e[12]||(e[12]=s("span",{class:"detail-label"},"Plataformas:",-1)),s("span",Ls,d(o.value[t.version]?.platforms||"Todas"),1)]),o.value[t.version]?.summary?(i(),l("div",js,[e[13]||(e[13]=s("span",{class:"detail-label"},"Resumen:",-1)),s("p",null,d(o.value[t.version]?.summary),1)])):h("",!0),o.value[t.version]?.fixes&&o.value[t.version]?.fixes.length>0?(i(),l("div",Ts,[e[16]||(e[16]=s("div",{class:"fixes-header"},[s("i",{class:"pi pi-wrench fixes-icon"}),s("span",{class:"detail-label"},"Correcciones principales:")],-1)),s("div",Vs,[(i(!0),l(S,null,j(o.value[t.version]?.fixes?.slice(0,3),(n,r)=>(i(),l("div",{key:r,class:"fix-item"},[e[14]||(e[14]=s("div",{class:"fix-bullet"},null,-1)),s("span",Bs,d(n),1)]))),128))]),o.value[t.version]?.fixes.length>3?(i(),l("div",Rs,[p(u(L),{label:`Ver todas (${o.value[t.version]?.fixes.length})`,icon:"pi pi-list",class:"p-button-text p-button-sm view-all-btn",onClick:n=>K(t.version)},null,8,["label","onClick"])])):h("",!0),p(u(os),{visible:w.value[t.version],"onUpdate:visible":n=>w.value[t.version]=n,header:`Correcciones completas - Versión ${t.version}`,modal:"",closable:!1,dismissableMask:"",class:"fixes-dialog",style:{width:"90vw",maxWidth:"800px"}},{footer:v(()=>[s("div",Ws,[p(u(L),{label:"Cerrar",icon:"pi pi-times",class:"p-button-outlined",onClick:n=>Q(t.version)},null,8,["onClick"])])]),default:v(()=>[s("div",Es,[s("div",Fs,[e[15]||(e[15]=s("i",{class:"pi pi-info-circle"},null,-1)),s("span",null,"Total de correcciones: "+d(o.value[t.version]?.fixes?.length),1)]),s("div",Is,[(i(!0),l(S,null,j(o.value[t.version]?.fixes,(n,r)=>(i(),l("div",{key:r,class:"dialog-fix-item"},[s("div",As,d(r+1),1),s("div",Ps,d(n),1)]))),128))])])]),_:2},1032,["visible","onUpdate:visible","header"])])):h("",!0),s("div",Hs,[s("a",{href:t.link,target:"_blank",class:"wiki-link"},[...e[17]||(e[17]=[s("i",{class:"pi pi-book"},null,-1),k(" Ver en wiki ",-1)])],8,qs),o.value[t.version]?.link?(i(),l("a",{key:0,href:o.value[t.version]?.link,target:"_blank",class:"official-link"},[...e[18]||(e[18]=[s("i",{class:"pi pi-globe"},null,-1),k(" Nota oficial ",-1)])],8,Os)):h("",!0)])])])])]),_:2},1024))),128))],4))])]),_:1}),p(ns,{name:"fade"},{default:v(()=>[T.value?(i(),l("button",{key:0,onClick:J,class:"scroll-top-button"},[...e[20]||(e[20]=[s("i",{class:"pi pi-arrow-up"},null,-1)])])):h("",!0)]),_:1})],64))}}),ae=is(Ys,[["__scopeId","data-v-026e8b0e"]]);export{ae as default};
