"use strict";const H=new Set,l=new WeakMap,b=new WeakMap,y=new WeakMap,k=new WeakMap,U=new WeakMap,E=new WeakMap,N=new WeakMap,M=new WeakSet;let g,B=0,S=0;const h="__aa_tgt",W="__aa_del",C="__aa_new",V=e=>{const n=Z(e);n&&n.forEach(t=>ee(t))},D=e=>{e.forEach(n=>{n.target===g&&J(),l.has(n.target)&&v(n.target)})};function G(e){const n=k.get(e);n?.disconnect();let t=l.get(e),o=0;const r=5;t||(t=x(e),l.set(e,t));const{offsetWidth:a,offsetHeight:d}=g,i=[t.top-r,a-(t.left+r+t.width),d-(t.top+r+t.height),t.left-r].map(c=>`${-1*Math.floor(c)}px`).join(" "),s=new IntersectionObserver(()=>{++o>1&&v(e)},{root:g,threshold:1,rootMargin:i});s.observe(e),k.set(e,s)}function v(e){clearTimeout(N.get(e));const n=$(e),t=O(n)?500:n.duration;N.set(e,setTimeout(async()=>{const o=y.get(e);try{await o?.finished,l.set(e,x(e)),G(e)}catch{}},t))}function J(){clearTimeout(N.get(g)),N.set(g,setTimeout(()=>{H.forEach(e=>q(e,n=>P(()=>v(n))))},100))}function K(e){setTimeout(()=>{U.set(e,setInterval(()=>P(v.bind(null,e)),2e3))},Math.round(2e3*Math.random()))}function P(e){typeof requestIdleCallback=="function"?requestIdleCallback(()=>e()):requestAnimationFrame(()=>e())}let j,T;const Q=typeof window<"u"&&"ResizeObserver"in window;Q&&(g=document.documentElement,j=new MutationObserver(V),T=new ResizeObserver(D),window.addEventListener("scroll",()=>{S=window.scrollY,B=window.scrollX}),T.observe(g));function Z(e){return e.reduce((n,t)=>[...n,...Array.from(t.addedNodes),...Array.from(t.removedNodes)],[]).every(n=>n.nodeName==="#comment")?!1:e.reduce((n,t)=>{if(n===!1)return!1;if(t.target instanceof Element){if(A(t.target),!n.has(t.target)){n.add(t.target);for(let o=0;o<t.target.children.length;o++){const r=t.target.children.item(o);if(r){if(W in r)return!1;A(t.target,r),n.add(r)}}}if(t.removedNodes.length)for(let o=0;o<t.removedNodes.length;o++){const r=t.removedNodes[o];if(W in r)return!1;r instanceof Element&&(n.add(r),A(t.target,r),b.set(r,[t.previousSibling,t.nextSibling]))}}return n},new Set)}function A(e,n){!n&&!(h in e)?Object.defineProperty(e,h,{value:e}):n&&!(h in n)&&Object.defineProperty(n,h,{value:e})}function ee(e){var n;const t=e.isConnected,o=l.has(e);t&&b.has(e)&&b.delete(e),y.has(e)&&((n=y.get(e))===null||n===void 0||n.cancel()),C in e?X(e):o&&t?te(e):o&&!t?oe(e):X(e)}function f(e){return Number(e.replace(/[^0-9.\-]/g,""))}function ne(e){let n=e.parentElement;for(;n;){if(n.scrollLeft||n.scrollTop)return{x:n.scrollLeft,y:n.scrollTop};n=n.parentElement}return{x:0,y:0}}function x(e){const n=e.getBoundingClientRect(),{x:t,y:o}=ne(e);return{top:n.top+o,left:n.left+t,width:n.width,height:n.height}}function z(e,n,t){let o=n.width,r=n.height,a=t.width,d=t.height;const i=getComputedStyle(e);if(i.getPropertyValue("box-sizing")==="content-box"){const s=f(i.paddingTop)+f(i.paddingBottom)+f(i.borderTopWidth)+f(i.borderBottomWidth),c=f(i.paddingLeft)+f(i.paddingRight)+f(i.borderRightWidth)+f(i.borderLeftWidth);o-=c,a-=c,r-=s,d-=s}return[o,a,r,d].map(Math.round)}function $(e){return h in e&&E.has(e[h])?E.get(e[h]):{duration:250,easing:"ease-in-out"}}function I(e){if(h in e)return e[h]}function _(e){const n=I(e);return n?M.has(n):!1}function q(e,...n){n.forEach(t=>t(e,E.has(e)));for(let t=0;t<e.children.length;t++){const o=e.children.item(t);o&&n.forEach(r=>r(o,E.has(o)))}}function R(e){return Array.isArray(e)?e:[e]}function O(e){return typeof e=="function"}function te(e){const n=l.get(e),t=x(e);if(!_(e))return l.set(e,t);let o;if(!n)return;const r=$(e);if(typeof r!="function"){const a=n.left-t.left,d=n.top-t.top,[i,s,c,p]=z(e,n,t),m={transform:`translate(${a}px, ${d}px)`},u={transform:"translate(0, 0)"};i!==s&&(m.width=`${i}px`,u.width=`${s}px`),c!==p&&(m.height=`${c}px`,u.height=`${p}px`),o=e.animate([m,u],{duration:r.duration,easing:r.easing})}else{const[a]=R(r(e,"remain",n,t));o=new Animation(a),o.play()}y.set(e,o),l.set(e,t),o.addEventListener("finish",v.bind(null,e))}function X(e){C in e&&delete e[C];const n=x(e);l.set(e,n);const t=$(e);if(!_(e))return;let o;if(typeof t!="function")o=e.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:t.duration*1.5,easing:"ease-in"});else{const[r]=R(t(e,"add",n));o=new Animation(r),o.play()}y.set(e,o),o.addEventListener("finish",v.bind(null,e))}function Y(e,n){var t;e.remove(),l.delete(e),b.delete(e),y.delete(e),(t=k.get(e))===null||t===void 0||t.disconnect(),setTimeout(()=>{if(W in e&&delete e[W],Object.defineProperty(e,C,{value:!0,configurable:!0}),n&&e instanceof HTMLElement)for(const o in n)e.style[o]=""},0)}function oe(e){var n;if(!b.has(e)||!l.has(e))return;const[t,o]=b.get(e);Object.defineProperty(e,W,{value:!0,configurable:!0});const r=window.scrollX,a=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(e,o):t&&t.parentNode?t.parentNode.appendChild(e):(n=I(e))===null||n===void 0||n.appendChild(e),!_(e))return Y(e);const[d,i,s,c]=ie(e),p=$(e),m=l.get(e);(r!==B||a!==S)&&re(e,r,a,p);let u,w={position:"absolute",top:`${d}px`,left:`${i}px`,width:`${s}px`,height:`${c}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!O(p))Object.assign(e.style,w),u=e.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:p.duration,easing:"ease-out"});else{const[F,L]=R(p(e,"remove",m));L?.styleReset!==!1&&(w=L?.styleReset||w,Object.assign(e.style,w)),u=new Animation(F),u.play()}y.set(e,u),u.addEventListener("finish",Y.bind(null,e,w))}function re(e,n,t,o){const r=B-n,a=S-t,d=document.documentElement.style.scrollBehavior;if(getComputedStyle(g).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+r,window.scrollY+a),!e.parentElement)return;const i=e.parentElement;let s=i.clientHeight,c=i.clientWidth;const p=performance.now();function m(){requestAnimationFrame(()=>{if(!O(o)){const u=s-i.clientHeight,w=c-i.clientWidth;p+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-w,top:window.scrollY-u}),s=i.clientHeight,c=i.clientWidth,m()):document.documentElement.style.scrollBehavior=d}})}m()}function ie(e){const n=l.get(e),[t,,o]=z(e,n,x(e));let r=e.parentElement;for(;r&&(getComputedStyle(r).position==="static"||r instanceof HTMLBodyElement);)r=r.parentElement;r||(r=document.body);const a=getComputedStyle(r),d=l.get(r)||x(r),i=Math.round(n.top-d.top)-f(a.borderTopWidth),s=Math.round(n.left-d.left)-f(a.borderLeftWidth);return[i,s,t,o]}function ae(e,n={}){return j&&T&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!O(n)&&!n.disrespectUserMotionPreference||(M.add(e),getComputedStyle(e).position==="static"&&Object.assign(e.style,{position:"relative"}),q(e,v,K,t=>T?.observe(t)),O(n)?E.set(e,n):E.set(e,{duration:250,easing:"ease-in-out",...n}),j.observe(e,{childList:!0}),H.add(e))),Object.freeze({parent:e,enable:()=>{M.add(e)},disable:()=>{M.delete(e)},isEnabled:()=>M.has(e)})}export{ae as a};
