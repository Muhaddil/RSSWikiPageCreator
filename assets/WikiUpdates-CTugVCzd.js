import{_ as D,r as n,q as $,o as R,w as S,J as V,b as r,K as f,d as s,O as u,c as _,F as i,x as d,I as B,E as c,a8 as M,Y as N,Q as T,R as A}from"./@vue-AaAR792z.js";import{_ as F}from"./logo-white-CwkOOWqZ.js";import{y as I,e as j,k as q,n as E,w as H}from"./primevue-B5xHOMrV.js";import{i as O,b as P}from"./main-ssWgOgYa.js";import"./@primevue-CoWSFWgT.js";import"./@primeuix-B3koxSuN.js";import"./@vueuse-CeyP63Rz.js";import"./pinia-DTMVEOtY.js";import"./parse-mediawiki-template--QNsUU1W.js";import"./vue-toastification-DhlY5ulG.js";const J={class:"space-page-container"},K={class:"flex items-start justify-between mb-6 header-container"},Q={class:"flex flex-col"},Y={class:"header-container"},G={class:"title-theme-container"},X={class:"galactic-title"},Z={class:"title-text"},ss={class:"text-stellar-gray mt-2"},es={class:"text-stellar-gray mt-2"},ts={class:"filter-container mb-6 p-4 bg-space-dark rounded-lg"},as={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ls={class:"flex"},is={class:"block mb-2"},os={class:"panel-content"},ns={class:"update-info mt-2"},rs={key:0,class:"loading-message"},ds={key:1,class:"error-message p-error"},cs={class:"p-4"},us={class:"flex flex-column gap-3"},ms={class:"flex align-items-center gap-2"},ps={class:"update-title"},vs={class:"update-details"},gs={class:"detail-item"},fs={class:"detail-value"},_s={class:"detail-item"},bs={class:"detail-value"},ks={class:"comment-box mt-3 p-3 bg-space-light rounded"},hs={class:"mt-1"},ws={class:"mt-3"},ys=["href"],xs=["href"],$s=D({__name:"WikiUpdates",setup(a){const e=n([]),l=n(!0),t=n(null),o=n(window.innerWidth),m=n(50),p=n(""),v=n(!1),g=$((()=>o.value<768?1:o.value<1200?2:3)),b=$((()=>v.value?"https://nomanssky.fandom.com/api.php":"https://nomanssky.fandom.com/es/api.php")),h=n([{value:25,label:"25 resultados"},{value:50,label:"50 resultados"},{value:100,label:"100 resultados"},{value:200,label:"200 resultados"},{value:300,label:"300 resultados"},{value:400,label:"400 resultados"},{value:500,label:"500 resultados"}]),k=async()=>{try{l.value=!0,t.value=null;const s=new URLSearchParams({action:"query",list:"recentchanges",rcprop:"title|timestamp|user|comment|ids|flags|loginfo|revid|old_revid",rclimit:m.value.toString(),rcshow:"!bot",rcdir:"older",format:"json",origin:"*",...p.value&&{rcuser:p.value}}),a=await fetch(`${b.value}?${s.toString()}`);if(!a.ok)throw new Error("Error en la API de la wiki");const i=await a.json();if(i.error)throw new Error(i.error.info);e.value=i.query.recentchanges.map((s=>({title:s.title,timestamp:s.timestamp,user:s.user,comment:s.comment||"(sin comentario)",pageid:s.pageid,revid:s.revid,old_revid:s.old_revid})))}catch(s){t.value="Error al cargar actualizaciones",console.error(s)}finally{l.value=!1}};R((async()=>{window.addEventListener("resize",(()=>o.value=window.innerWidth)),await k()})),S(v,(()=>{k()})),S(m,(()=>{k()}));const w=s=>s.trim().replace(/\s+/g,"_").replace(/\//g,"_"),y=s=>{const a=new Date,e=new Date(s),l=a.getTime()-e.getTime(),i=Math.floor(l/6e4);if(i<60)return`Hace ${i} min`;const t=Math.floor(i/60);return t<24?`Hace ${t} h`:`Hace ${Math.floor(t/24)} días`},x=s=>new Date(s).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return(a,o)=>(r(),V(d(E),{class:"p-0 galactic-card"},{content:f((()=>[s("div",J,[s("div",K,[s("div",Q,[o[3]||(o[3]=s("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[s("div",{class:"wiki-logo"},[s("img",{src:F,class:"logo-image",alt:"Wiki Logo"})])],-1)),s("div",Y,[s("div",G,[s("h1",X,[s("span",Z,"Actualizaciones Recientes - Wiki "+i(v.value?"EN":"ES"),1)])])]),s("p",ss," Últimos cambios en la wiki "+i(v.value?"inglesa":"española")+" de No Man's Sky ",1)]),s("p",es,[u(O,{style:{"margin-right":"2rem"}})])]),s("div",ts,[s("div",as,[s("div",null,[o[4]||(o[4]=s("label",{class:"block mb-6 text-stellar-blue font-medium"},"Resultados:",-1)),u(d(I),{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),options:h.value,optionLabel:"label",optionValue:"value",class:"w-full ml-2",pt:{root:{class:"bg-space-light border-space-blue"},input:{class:"text-stellar-light"},trigger:{class:"bg-space-blue"}}},null,8,["modelValue","options"])]),s("div",null,[o[5]||(o[5]=s("label",{class:"block mb-2"},"Filtrar por usuario:",-1)),s("div",ls,[u(d(j),{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=s=>p.value=s),placeholder:"Nombre de usuario",class:"w-full"},null,8,["modelValue"]),s("button",{onClick:k,class:"p-button p-component ml-2"}," Buscar ")])])]),s("div",null,[s("label",is,[B(s("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),class:"mr-2"},null,512),[[M,v.value]]),o[6]||(o[6]=c(" Consultar wiki en inglés "))])])]),u(d(q),{class:"galactic-panel"},{header:f((()=>o[7]||(o[7]=[s("h2",{class:"panel-title"},"Información de Actualizaciones",-1)]))),default:f((()=>[s("div",os,[s("p",null,[o[8]||(o[8]=c(" Total de cambios recientes: ")),s("strong",null,i(e.value.length),1)]),s("p",ns,"Actualizado: "+i((new Date).toLocaleString("es-ES")),1)])])),_:1}),o[17]||(o[17]=s("br",null,null,-1)),l.value?(r(),_("div",rs,o[9]||(o[9]=[s("i",{class:"pi pi-spinner pi-spin"},null,-1),c(" Cargando actualizaciones... ")]))):t.value?(r(),_("div",ds,[o[10]||(o[10]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),c(" "+i(t.value),1)])):(r(),_("div",{key:2,class:"grid gap-4",style:N(`grid-template-columns: repeat(${g.value}, 1fr)`)},[(r(!0),_(T,null,A(e.value,((a,e)=>(r(),V(d(E),{key:e,class:"update-card"},{content:f((()=>[s("div",cs,[s("div",us,[s("div",ms,[s("h3",ps,i(a.title),1),u(d(H),{value:y(a.timestamp),severity:"info",class:"time-tag"},null,8,["value"])]),s("div",vs,[s("div",gs,[o[11]||(o[11]=s("span",{class:"detail-label"},"Usuario:",-1)),s("span",fs,i(a.user),1)]),s("div",_s,[o[12]||(o[12]=s("span",{class:"detail-label"},"Fecha:",-1)),s("span",bs,i(x(a.timestamp)),1)]),s("div",ks,[o[13]||(o[13]=s("span",{class:"detail-label"},"Comentario:",-1)),s("p",hs,i(a.comment),1)])]),s("div",ws,[s("a",{href:`https://nomanssky.fandom.com/${v.value?"":"es/"}wiki/${w(a.title)}`,target:"_blank",class:"wiki-link"},o[14]||(o[14]=[s("i",{class:"pi pi-external-link"},null,-1),c(" Ver página en la wiki ")]),8,ys),o[16]||(o[16]=s("span",{class:"mx-2"},"|",-1)),s("a",{href:`https://nomanssky.fandom.com/${v.value?"":"es/"}wiki/${w(a.title)}?diff=${a.revid}&oldid=${a.old_revid}`,target:"_blank",class:"wiki-link"},o[15]||(o[15]=[s("i",{class:"pi pi-history"},null,-1),c(" Ver cambios ")]),8,xs)])])])])),_:2},1024)))),128))],4))])])),_:1}))}}),As=P($s,[["__scopeId","data-v-b749a47c"]]);export{As as default};
