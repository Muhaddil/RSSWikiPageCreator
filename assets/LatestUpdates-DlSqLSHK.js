import{_ as Q}from"./logo-white-CwkOOWqZ.js";import{A as Y,s as G,k as X,n as I,w as Z}from"./primevue-DZaJwgSn.js";import{i as ss,b as es}from"./main-5NVWaTff.js";import{g as ts}from"./api-vPU2WsH5.js";import{_ as as,q as R,r as k,o as ns,J as V,b as i,K as N,d as e,O as w,c,x as y,E as S,F as m,Y as os,Q as E,R as A,L as U}from"./@vue-CY8teviB.js";import"./@primevue-6Fs5n1H9.js";import"./@primeuix-B3koxSuN.js";import"./@vueuse-CQ3z5dk_.js";import"./pinia-Y4zTcgzN.js";import"./parse-mediawiki-template--QNsUU1W.js";import"./vue-toastification-QGdlMhOT.js";const is={class:"space-page-container"},ls={class:"flex items-start justify-between mb-6 header-container"},rs={class:"flex flex-col"},cs={class:"text-stellar-gray mt-2"},ds={class:"mb-4 flex items-center gap-2"},ps={class:"panel-content"},ms={class:"update-info"},us={key:0,class:"loading-message"},fs={key:1,class:"error-message p-error"},gs={class:"p-4"},vs={class:"flex flex-column gap-3"},hs={class:"flex align-items-center gap-2"},ks={class:"update-title"},ys={class:"flex justify-between items-center mb-3"},_s={class:"update-date"},xs={class:"update-date-formatted"},bs={key:0,class:"image-container"},ws=["src","alt"],Ss={class:"update-details"},$s={class:"detail-item"},Ns={class:"detail-value"},Us={key:0,class:"summary-box"},Cs={key:1,class:"fixes-box"},Ms={class:"mt-3 flex justify-between"},zs=["href"],Ls=["href"],Ds=as({__name:"LatestUpdates",setup(s){const a=R((()=>u.value.slice(0,o.value))),l=k({}),t=k(!0),n=k(null),r=k(window.innerWidth),o=k(10),u=k([]),p=R((()=>r.value<768?1:r.value<1200?2:3)),d=async()=>{try{const s=new URLSearchParams({action:"parse",page:"Noticias",prop:"text",format:"json",origin:"*"}),e=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${s.toString()}`)).json()).parse.text["*"];v(e)}catch(s){n.value="Error al cargar las noticias",console.error(s)}},v=s=>{var e,a;const l=new DOMParser,t=l.parseFromString(s,"text/html").querySelector(".plainlinks");if(!t)return;const i=[],n=t.innerHTML.split("<br>");for(const s of n){if(!s.trim())continue;const t=l.parseFromString(s,"text/html"),n=t.querySelector("a");if(n){const s=(null==(e=n.textContent)?void 0:e.trim())||"",l=n.getAttribute("href")||"",r=decodeURIComponent(l.split("/wiki/").pop()||"").replace(/_/g," ").match(/(\d+\.\d+(\.\d+)?)/),o=null==(a=t.body.textContent)?void 0:a.match(/(\d{1,2} de [a-z]+ de \d{4})/i);r&&o&&i.push({title:s,link:`https://nomanssky.fandom.com${l}`,date:o[1],version:r[1]})}}u.value=i,f()},f=async()=>{try{for(const s of a.value){const e=await g(s.link);e&&(l.value[s.version]=e)}}catch(s){console.error("Error fetching update details:",s)}finally{t.value=!1}},g=async s=>{try{const e=s.split("/wiki/")[1],a=new URLSearchParams({action:"parse",page:decodeURIComponent(e),prop:"wikitext",format:"json",origin:"*"}),l=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${a.toString()}`)).json()).parse.wikitext["*"];return h(l,e)}catch(e){return console.error(`Error fetching details for ${s}:`,e),{}}},h=async(s,e)=>{var a;const l={fixes:[]},t=s.match(/\|\s*image\s*=\s*(.+?)\n/);if(t){const s=t[1].split("\n")[0].split("|")[0].trim(),e=await ts(s);e&&(l.image=e)}const i=s.match(/\|\s*date\s*=\s*(.+?)\n/);i&&(l.date=i[1].trim());const n=s.match(/\|\s*platform\s*=\s*(.+?)\n/);n&&(l.platforms=n[1].trim());const r=s.match(/\|\s*link\s*=\s*\[(https?:\/\/[^\s\]]+)(?:\s[^\]]*)?\]/);r&&(l.link=r[1].trim());const o=s.match(/==\s*Resumen\s*==\s*\n([\s\S]*?)(?=\n==|$)/);o&&(l.summary=(s=>(s=(s=(s=(s=s.replace(/'''/g,"")).replace(/''/g,"")).replace(/\[\[([^\|\]]+)\|([^\]]+)\]\]/g,"$2")).replace(/\[\[([^\]]+)\]\]/g,"$1")).replace(/<br\s*\/?>/gi,"\n"))(o[1].trim()));const c=s.match(/==\s*corre(?:cción|cciones)\s+de\s+errores?\s*==\s*\n([\s\S]*?)(?=\n==|$)/i);if(c){const s=c[1].matchAll(/\*\s*(.+?)(?=\n\*|\n$)/g);for(const e of s){const s=e[1].replace(/\s+/g," ").trim();null==(a=l.fixes)||a.push(s)}}return l};ns((()=>{window.addEventListener("resize",(()=>r.value=window.innerWidth)),d()}));const x=()=>{t.value=!0,n.value=null,u.value=[],l.value={},d()},b=s=>{const e={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12"},a=s.split(" de ");if(3===a.length){return`${a[0].padStart(2,"0")}/${e[a[1].toLowerCase()]}/${a[2]}`}return s};return(s,r)=>(i(),V(y(I),{class:"p-0 galactic-card"},{content:N((()=>[e("div",is,[e("div",ls,[e("div",rs,[r[1]||(r[1]=e("a",{href:"https://nomanssky.fandom.com/es/wiki/No_Man%27s_Sky_Wiki",target:"_blank"},[e("div",{class:"wiki-logo"},[e("img",{src:Q,class:"logo-image",alt:"Wiki Logo"})])],-1)),r[2]||(r[2]=e("div",{class:"header-container"},[e("div",{class:"title-theme-container"},[e("h1",{class:"galactic-title"},[e("span",{class:"title-text"},"Actualizaciones de No Man's Sky")])])],-1)),r[3]||(r[3]=e("p",{class:"text-stellar-gray mt-2"},"Últimas actualizaciones del juego desde la wiki oficial",-1)),e("p",cs,[w(ss,{style:{"margin-right":"2rem"}})])])]),e("div",ds,[r[4]||(r[4]=e("label",{for:"maxUpdates",class:"text-stellar-gray font-semibold"},"Mostrar hasta:",-1)),w(y(Y),{id:"maxUpdates",modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=s=>o.value=s),min:1,max:15,showButtons:!0,inputClass:"p-inputtext-sm",class:"mx-2"},null,8,["modelValue"]),r[5]||(r[5]=e("span",{class:"text-stellar-gray"},"actualizaciones",-1)),r[6]||(r[6]=e("br",null,null,-1)),r[7]||(r[7]=e("br",null,null,-1)),w(y(G),{label:"Buscar Actualizaciones",icon:"pi pi-refresh",class:"p-button-outlined p-button-sm",onClick:x})]),w(y(X),{class:"galactic-panel"},{header:N((()=>r[8]||(r[8]=[e("h2",{class:"panel-title"},"Historial de Actualizaciones",-1)]))),default:N((()=>[e("div",ps,[e("p",null,[r[9]||(r[9]=S(" Total de actualizaciones recientes: ")),e("strong",null,m(a.value.length),1)]),e("p",ms,"Última actualización: "+m((new Date).toLocaleDateString("es-ES")),1)])])),_:1}),r[17]||(r[17]=e("br",null,null,-1)),t.value?(i(),c("div",us,r[10]||(r[10]=[e("i",{class:"pi pi-spinner pi-spin"},null,-1),S(" Cargando actualizaciones... ")]))):n.value?(i(),c("div",fs,[r[11]||(r[11]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),S(" "+m(n.value),1)])):(i(),c("div",{key:2,class:"grid gap-4",style:os(`grid-template-columns: repeat(${p.value}, 1fr)`)},[(i(!0),c(E,null,A(a.value,((s,a)=>(i(),V(y(I),{key:a,class:"update-card"},{content:N((()=>{var a,t,n,o,u,p,d,v,f,g,h,k;return[e("div",gs,[e("div",vs,[e("div",hs,[e("h3",ks,m(s.title),1),w(y(Z),{value:s.version,severity:"info",class:"version-tag"},null,8,["value"])]),e("div",ys,[e("span",_s,m(s.date),1),e("span",xs,m(b(s.date)),1)]),null!=(a=l.value[s.version])&&a.image?(i(),c("div",bs,[e("img",{src:null==(n=null==(t=l.value[s.version])?void 0:t.image)?void 0:n.panel,alt:s.title,class:"update-image"},null,8,ws)])):U("",!0),e("div",Ss,[e("div",$s,[r[12]||(r[12]=e("span",{class:"detail-label"},"Plataformas:",-1)),e("span",Ns,m((null==(o=l.value[s.version])?void 0:o.platforms)||"Todas"),1)]),null!=(u=l.value[s.version])&&u.summary?(i(),c("div",Us,[r[13]||(r[13]=e("span",{class:"detail-label"},"Resumen:",-1)),e("p",null,m(null==(p=l.value[s.version])?void 0:p.summary),1)])):U("",!0),null!=(d=l.value[s.version])&&d.fixes&&(null==(v=l.value[s.version])?void 0:v.fixes.length)>0?(i(),c("div",Cs,[r[14]||(r[14]=e("span",{class:"detail-label"},"Principales correcciones:",-1)),e("ul",null,[(i(!0),c(E,null,A(null==(g=null==(f=l.value[s.version])?void 0:f.fixes)?void 0:g.slice(0,3),((s,e)=>(i(),c("li",{key:e},m(s),1)))),128))])])):U("",!0),e("div",Ms,[e("a",{href:s.link,target:"_blank",class:"wiki-link"},r[15]||(r[15]=[e("i",{class:"pi pi-book"},null,-1),S(" Ver en wiki ")]),8,zs),null!=(h=l.value[s.version])&&h.link?(i(),c("a",{key:0,href:null==(k=l.value[s.version])?void 0:k.link,target:"_blank",class:"official-link"},r[16]||(r[16]=[e("i",{class:"pi pi-globe"},null,-1),S(" Nota oficial ")]),8,Ls)):U("",!0)])])])])]})),_:2},1024)))),128))],4))])])),_:1}))}}),Js=es(Ds,[["__scopeId","data-v-15d7cd36"]]);export{Js as default};
