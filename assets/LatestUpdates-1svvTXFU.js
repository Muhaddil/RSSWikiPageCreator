import{_ as Q}from"./logo-white-CwkOOWqZ.js";import{A as Y,s as G,k as X,n as R,w as Z}from"./primevue-B5xHOMrV.js";import{i as ss,b as es}from"./main-AFFqryE_.js";import{g as ts}from"./api-vPU2WsH5.js";import{_ as as,q as I,r as y,o as ns,J as V,b as i,K as N,d as e,O as w,c,x as _,E as S,F as m,Y as os,Q as E,R as A,L as U}from"./@vue-AaAR792z.js";import"./@primevue-CoWSFWgT.js";import"./@primeuix-B3koxSuN.js";/* empty css              */import"./@vueuse-CeyP63Rz.js";import"./pinia-DTMVEOtY.js";import"./parse-mediawiki-template--QNsUU1W.js";import"./vue-toastification-DhlY5ulG.js";/* empty css                   */const is={class:"space-page-container"},ls={class:"flex items-start justify-between mb-6 header-container"},rs={class:"flex flex-col"},cs={class:"text-stellar-gray mt-2"},ps={class:"mb-4 flex items-center gap-2"},ds={class:"panel-content"},ms={class:"update-info"},us={key:0,class:"loading-message"},fs={key:1,class:"error-message p-error"},gs={class:"p-4"},vs={class:"flex flex-column gap-3"},hs={class:"flex align-items-center gap-2"},ys={class:"update-title"},_s={class:"flex justify-between items-center mb-3"},ks={class:"update-date"},bs={class:"update-date-formatted"},xs={key:0,class:"image-container"},ws=["src","alt"],Ss={class:"update-details"},$s={class:"detail-item"},Ns={class:"detail-value"},Us={key:0,class:"summary-box"},Cs={key:1,class:"fixes-box"},zs={class:"mt-3 flex justify-between"},Ls=["href"],Ms=["href"],Ds=as({__name:"LatestUpdates",setup(js){const C=I(()=>D.value.slice(0,M.value)),n=y({}),z=y(!0),$=y(null),L=y(window.innerWidth),M=y(10),D=y([]),B=I(()=>L.value<768?1:L.value<1200?2:3),j=async()=>{try{const t=new URLSearchParams({action:"parse",page:"Noticias",prop:"text",format:"json",origin:"*"}),o=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${t.toString()}`)).json()).parse.text["*"];P(o)}catch(t){$.value="Error al cargar las noticias",console.error(t)}},P=t=>{var u,f;const s=new DOMParser,o=s.parseFromString(t,"text/html").querySelector(".plainlinks");if(!o)return;const l=[],r=o.innerHTML.split("<br>");for(const g of r){if(!g.trim())continue;const v=s.parseFromString(g,"text/html"),p=v.querySelector("a");if(p){const d=((u=p.textContent)==null?void 0:u.trim())||"",h=p.getAttribute("href")||"",b=decodeURIComponent(h.split("/wiki/").pop()||"").replace(/_/g," ").match(/(\d+\.\d+(\.\d+)?)/),x=(f=v.body.textContent)==null?void 0:f.match(/(\d{1,2} de [a-z]+ de \d{4})/i);b&&x&&l.push({title:d,link:`https://nomanssky.fandom.com${h}`,date:x[1],version:b[1]})}}D.value=l,T()},T=async()=>{try{for(const t of C.value){const s=await W(t.link);s&&(n.value[t.version]=s)}}catch(t){console.error("Error fetching update details:",t)}finally{z.value=!1}},W=async t=>{try{const s=t.split("/wiki/")[1],a=new URLSearchParams({action:"parse",page:decodeURIComponent(s),prop:"wikitext",format:"json",origin:"*"}),r=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${a.toString()}`)).json()).parse.wikitext["*"];return q(r,s)}catch(s){return console.error(`Error fetching details for ${t}:`,s),{}}},F=t=>(t=t.replace(/'''/g,""),t=t.replace(/''/g,""),t=t.replace(/\[\[([^\|\]]+)\|([^\]]+)\]\]/g,"$2"),t=t.replace(/\[\[([^\]]+)\]\]/g,"$1"),t=t.replace(/<br\s*\/?>/gi,`
`),t),q=async(t,s)=>{var v;const a={fixes:[]},o=t.match(/\|\s*image\s*=\s*(.+?)\n/);if(o){const p=o[1].split(`
`)[0].split("|")[0].trim(),d=await ts(p);d&&(a.image=d)}const l=t.match(/\|\s*date\s*=\s*(.+?)\n/);l&&(a.date=l[1].trim());const r=t.match(/\|\s*platform\s*=\s*(.+?)\n/);r&&(a.platforms=r[1].trim());const u=t.match(/\|\s*link\s*=\s*\[(https?:\/\/[^\s\]]+)(?:\s[^\]]*)?\]/);u&&(a.link=u[1].trim());const f=t.match(/==\s*Resumen\s*==\s*\n([\s\S]*?)(?=\n==|$)/);f&&(a.summary=F(f[1].trim()));const g=t.match(/==\s*corre(?:cción|cciones)\s+de\s+errores?\s*==\s*\n([\s\S]*?)(?=\n==|$)/i);if(g){const d=g[1].matchAll(/\*\s*(.+?)(?=\n\*|\n$)/g);for(const h of d){const k=h[1].replace(/\s+/g," ").trim();(v=a.fixes)==null||v.push(k)}}return a};ns(()=>{window.addEventListener("resize",()=>L.value=window.innerWidth),j()});const H=()=>{z.value=!0,$.value=null,D.value=[],n.value={},j()},O=t=>{const s={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12"},a=t.split(" de ");if(a.length===3){const o=a[0].padStart(2,"0"),l=s[a[1].toLowerCase()],r=a[2];return`${o}/${l}/${r}`}return t};return(t,s)=>(i(),V(_(R),{class:"p-0 galactic-card"},{content:N(()=>[e("div",is,[e("div",ls,[e("div",rs,[s[1]||(s[1]=e("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[e("div",{class:"wiki-logo"},[e("img",{src:Q,class:"logo-image",alt:"Wiki Logo"})])],-1)),s[2]||(s[2]=e("div",{class:"header-container"},[e("div",{class:"title-theme-container"},[e("h1",{class:"galactic-title"},[e("span",{class:"title-text"},"Actualizaciones de No Man's Sky")])])],-1)),s[3]||(s[3]=e("p",{class:"text-stellar-gray mt-2"},"Últimas actualizaciones del juego desde la wiki oficial",-1)),e("p",cs,[w(ss,{style:{"margin-right":"2rem"}})])])]),e("div",ps,[s[4]||(s[4]=e("label",{for:"maxUpdates",class:"text-stellar-gray font-semibold"},"Mostrar hasta:",-1)),w(_(Y),{id:"maxUpdates",modelValue:M.value,"onUpdate:modelValue":s[0]||(s[0]=a=>M.value=a),min:1,max:15,showButtons:!0,inputClass:"p-inputtext-sm",class:"mx-2"},null,8,["modelValue"]),s[5]||(s[5]=e("span",{class:"text-stellar-gray"},"actualizaciones",-1)),s[6]||(s[6]=e("br",null,null,-1)),s[7]||(s[7]=e("br",null,null,-1)),w(_(G),{label:"Buscar Actualizaciones",icon:"pi pi-refresh",class:"p-button-outlined p-button-sm",onClick:H})]),w(_(X),{class:"galactic-panel"},{header:N(()=>s[8]||(s[8]=[e("h2",{class:"panel-title"},"Historial de Actualizaciones",-1)])),default:N(()=>[e("div",ds,[e("p",null,[s[9]||(s[9]=S(" Total de actualizaciones recientes: ")),e("strong",null,m(C.value.length),1)]),e("p",ms,"Última actualización: "+m(new Date().toLocaleDateString("es-ES")),1)])]),_:1}),s[17]||(s[17]=e("br",null,null,-1)),z.value?(i(),c("div",us,s[10]||(s[10]=[e("i",{class:"pi pi-spinner pi-spin"},null,-1),S(" Cargando actualizaciones... ")]))):$.value?(i(),c("div",fs,[s[11]||(s[11]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),S(" "+m($.value),1)])):(i(),c("div",{key:2,class:"grid gap-4",style:os(`grid-template-columns: repeat(${B.value}, 1fr)`)},[(i(!0),c(E,null,A(C.value,(a,o)=>(i(),V(_(R),{key:o,class:"update-card"},{content:N(()=>{var l,r,u,f,g,v,p,d,h,k,b,x;return[e("div",gs,[e("div",vs,[e("div",hs,[e("h3",ys,m(a.title),1),w(_(Z),{value:a.version,severity:"info",class:"version-tag"},null,8,["value"])]),e("div",_s,[e("span",ks,m(a.date),1),e("span",bs,m(O(a.date)),1)]),(l=n.value[a.version])!=null&&l.image?(i(),c("div",xs,[e("img",{src:(u=(r=n.value[a.version])==null?void 0:r.image)==null?void 0:u.panel,alt:a.title,class:"update-image"},null,8,ws)])):U("",!0),e("div",Ss,[e("div",$s,[s[12]||(s[12]=e("span",{class:"detail-label"},"Plataformas:",-1)),e("span",Ns,m(((f=n.value[a.version])==null?void 0:f.platforms)||"Todas"),1)]),(g=n.value[a.version])!=null&&g.summary?(i(),c("div",Us,[s[13]||(s[13]=e("span",{class:"detail-label"},"Resumen:",-1)),e("p",null,m((v=n.value[a.version])==null?void 0:v.summary),1)])):U("",!0),(p=n.value[a.version])!=null&&p.fixes&&((d=n.value[a.version])==null?void 0:d.fixes.length)>0?(i(),c("div",Cs,[s[14]||(s[14]=e("span",{class:"detail-label"},"Principales correcciones:",-1)),e("ul",null,[(i(!0),c(E,null,A((k=(h=n.value[a.version])==null?void 0:h.fixes)==null?void 0:k.slice(0,3),(J,K)=>(i(),c("li",{key:K},m(J),1))),128))])])):U("",!0),e("div",zs,[e("a",{href:a.link,target:"_blank",class:"wiki-link"},s[15]||(s[15]=[e("i",{class:"pi pi-book"},null,-1),S(" Ver en wiki ")]),8,Ls),(b=n.value[a.version])!=null&&b.link?(i(),c("a",{key:0,href:(x=n.value[a.version])==null?void 0:x.link,target:"_blank",class:"official-link"},s[16]||(s[16]=[e("i",{class:"pi pi-globe"},null,-1),S(" Nota oficial ")]),8,Ms)):U("",!0)])])])])]}),_:2},1024))),128))],4))])]),_:1}))}}),Js=es(Ds,[["__scopeId","data-v-b499f590"]]);export{Js as default};
