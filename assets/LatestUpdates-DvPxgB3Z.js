"use strict";import{d as Y,c as L,r as m,x as N,y as Z,a as n,o as t,f as d,k,b as a,b3 as G,h as g,Z as J,g as b,t as c,B as K,F as U,H as P,j as Q,e as x,a9 as X,p as ee}from"./main-C3ZFrW4z.js";import{_ as ae}from"./logo-white-CwkOOWqZ.js";import{s as T}from"./index-DznEzRt3.js";import{s as se}from"./index-C7ry7zg_.js";import{s as le}from"./index-2nRPZu-D.js";import{s as te}from"./index-DSX7woOc.js";import{g as ie}from"./api-Bbdr4r4D.js";import"./index-CznIfS9T.js";const ne={class:"space-page-container"},re={class:"flex items-start justify-between mb-6 header-container"},oe={class:"flex flex-col"},ce={class:"text-stellar-gray mt-2"},pe={class:"mb-4 flex items-center gap-2"},ue={class:"panel-content"},me={class:"update-info"},de={key:0,class:"loading-message"},ve={key:1,class:"error-message p-error"},fe={class:"p-4"},ge={class:"flex flex-column gap-3"},he={class:"flex align-items-center gap-2"},ye={class:"update-title"},ke={class:"flex justify-between items-center mb-3"},be={class:"update-date"},xe={class:"update-date-formatted"},we={key:0,class:"image-container"},Se=["src","alt"],_e={class:"update-details"},$e={class:"detail-item"},je={class:"detail-value"},ze={key:0,class:"summary-box"},Ce={key:1,class:"fixes-box"},Le={class:"mt-3 flex justify-between"},Ue=["href"],Re=["href"],Ae=Y({__name:"LatestUpdates",setup(Me){const h=L(()=>C.value.slice(0,z.value)),i=m({}),$=m(!0),w=m(null),j=m(window.innerWidth),z=m(10),C=m([]),R=m(!1),B=L(()=>j.value<768?1:j.value<1200?2:3),A=async()=>{try{const s=new URLSearchParams({action:"parse",page:"Noticias",prop:"text",format:"json",origin:"*"}),e=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${s.toString()}`)).json()).parse.text["*"];H(e)}catch(s){w.value="Error al cargar las noticias",console.error(s)}},H=s=>{const e=new DOMParser,l=e.parseFromString(s,"text/html").querySelector(".plainlinks");if(!l)return;const r=[],p=l.innerHTML.split("<br>");for(const o of p){if(!o.trim())continue;const y=e.parseFromString(o,"text/html"),v=y.querySelector("a");if(v){const S=v.textContent?.trim()||"",f=v.getAttribute("href")||"",u=decodeURIComponent(f.split("/wiki/").pop()||"").replace(/_/g," ").match(/(\d+\.\d+(\.\d+)?)/),_=y.body.textContent?.match(/(\d{1,2} de [a-z]+ de \d{4})/i);u&&_&&r.push({title:S,link:`https://nomanssky.fandom.com${f}`,date:_[1],version:u[1]})}}C.value=r,V()},V=async()=>{try{for(const s of h.value){const e=await F(s.link);e&&(i.value[s.version]=e)}}catch(s){console.error("Error fetching update details:",s)}finally{$.value=!1}},F=async s=>{try{const e=s.split("/wiki/")[1],l=new URLSearchParams({action:"parse",page:decodeURIComponent(e),prop:"wikitext",format:"json",origin:"*"}),r=(await(await fetch(`https://nomanssky.fandom.com/es/api.php?${l.toString()}`)).json()).parse.wikitext["*"];return W(r,e)}catch(e){return console.error(`Error fetching details for ${s}:`,e),{}}},I=s=>(s=s.replace(/'''/g,""),s=s.replace(/''/g,""),s=s.replace(/\[\[([^\|\]]+)\|([^\]]+)\]\]/g,"$2"),s=s.replace(/\[\[([^\]]+)\]\]/g,"$1"),s=s.replace(/<br\s*\/?>/gi,`
`),s),W=async(s,e)=>{const l={fixes:[]},r=s.match(/\|\s*image\s*=\s*(.+?)\n/);if(r){const f=r[1].split(`
`)[0].split("|")[0].trim(),u=await ie(f);u&&(l.image=u)}const p=s.match(/\|\s*date\s*=\s*(.+?)\n/);p&&(l.date=p[1].trim());const o=s.match(/\|\s*platform\s*=\s*(.+?)\n/);o&&(l.platforms=o[1].trim());const y=s.match(/\|\s*link\s*=\s*\[(https?:\/\/[^\s\]]+)(?:\s[^\]]*)?\]/);y&&(l.link=y[1].trim());const v=s.match(/==\s*Resumen\s*==\s*\n([\s\S]*?)(?=\n==|$)/);v&&(l.summary=I(v[1].trim()));const S=s.match(/==\s*corre(?:cciÃ³n|cciones)\s+de\s+errores?\s*==\s*\n([\s\S]*?)(?=\n==|$)/i);if(S){const f=S[1].matchAll(/\*\s*(.+?)(?=\n\*|\n$)/g);for(const u of f){const _=u[1].replace(/\s+/g," ").trim();l.fixes?.push(_)}}return l};N(()=>{window.addEventListener("resize",()=>j.value=window.innerWidth),A()});const q=()=>{$.value=!0,w.value=null,C.value=[],i.value={},A()},E=s=>{const e={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12"},l=s.split(" de ");if(l.length===3){const r=l[0].padStart(2,"0"),p=e[l[1].toLowerCase()],o=l[2];return`${r}/${p}/${o}`}return s},D=L(()=>h.value.length>0?E(h.value[0].date):"N/A"),M=()=>{R.value=window.scrollY>300},O=()=>{window.scrollTo({top:0,behavior:"smooth"})};return N(()=>{window.addEventListener("scroll",M)}),Z(()=>{window.removeEventListener("scroll",M)}),(s,e)=>(t(),n(U,null,[d(g(T),{class:"p-0 galactic-card"},{content:k(()=>[a("div",ne,[a("div",re,[a("div",oe,[e[1]||(e[1]=a("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[a("div",{class:"wiki-logo"},[a("img",{src:ae,class:"logo-image",alt:"Wiki Logo"})])],-1)),e[2]||(e[2]=a("div",{class:"header-container"},[a("div",{class:"title-theme-container"},[a("h1",{class:"galactic-title"},[a("span",{class:"title-text"},"Actualizaciones de No Man's Sky")])])],-1)),e[3]||(e[3]=a("p",{class:"text-stellar-gray mt-2"},"\xDAltimas actualizaciones del juego desde la wiki oficial",-1)),a("p",ce,[d(G,{style:{"margin-right":"2rem"}})])])]),a("div",pe,[e[4]||(e[4]=a("label",{for:"maxUpdates",class:"text-stellar-gray font-semibold"},"Mostrar hasta:",-1)),d(g(te),{id:"maxUpdates",modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=l=>z.value=l),min:1,max:15,showButtons:!0,inputClass:"p-inputtext-sm",class:"mx-2"},null,8,["modelValue"]),e[5]||(e[5]=a("span",{class:"text-stellar-gray"},"actualizaciones",-1)),e[6]||(e[6]=a("br",null,null,-1)),e[7]||(e[7]=a("br",null,null,-1)),d(g(J),{label:"Buscar Actualizaciones",icon:"pi pi-refresh",class:"p-button-outlined p-button-sm",onClick:q})]),d(g(le),{class:"galactic-panel"},{header:k(()=>[...e[8]||(e[8]=[a("h2",{class:"panel-title"},"Historial de Actualizaciones",-1)])]),default:k(()=>[a("div",ue,[a("p",null,[e[9]||(e[9]=b(" Total de actualizaciones recientes: ",-1)),a("strong",null,c(h.value.length),1)]),a("p",me,"\xDAltima actualizaci\xF3n: "+c(D.value),1)])]),_:1}),e[17]||(e[17]=a("br",null,null,-1)),$.value?(t(),n("div",de,[...e[10]||(e[10]=[a("i",{class:"pi pi-spinner pi-spin"},null,-1),b(" Cargando actualizaciones... ",-1)])])):w.value?(t(),n("div",ve,[e[11]||(e[11]=a("i",{class:"pi pi-exclamation-triangle"},null,-1)),b(" "+c(w.value),1)])):(t(),n("div",{key:2,class:"grid gap-4",style:K(`grid-template-columns: repeat(${B.value}, 1fr)`)},[(t(!0),n(U,null,P(h.value,(l,r)=>(t(),Q(g(T),{key:r,class:"update-card"},{content:k(()=>[a("div",fe,[a("div",ge,[a("div",he,[a("h3",ye,c(l.title),1),d(g(se),{value:l.version,severity:"info",class:"version-tag"},null,8,["value"])]),a("div",ke,[a("span",be,c(l.date),1),a("span",xe,c(E(l.date)),1)]),i.value[l.version]?.image?(t(),n("div",we,[a("img",{src:i.value[l.version]?.image?.panel,alt:l.title,class:"update-image"},null,8,Se)])):x("",!0),a("div",_e,[a("div",$e,[e[12]||(e[12]=a("span",{class:"detail-label"},"Plataformas:",-1)),a("span",je,c(i.value[l.version]?.platforms||"Todas"),1)]),i.value[l.version]?.summary?(t(),n("div",ze,[e[13]||(e[13]=a("span",{class:"detail-label"},"Resumen:",-1)),a("p",null,c(i.value[l.version]?.summary),1)])):x("",!0),i.value[l.version]?.fixes&&i.value[l.version]?.fixes.length>0?(t(),n("div",Ce,[e[14]||(e[14]=a("span",{class:"detail-label"},"Principales correcciones:",-1)),a("ul",null,[(t(!0),n(U,null,P(i.value[l.version]?.fixes?.slice(0,3),(p,o)=>(t(),n("li",{key:o},c(p),1))),128))])])):x("",!0),a("div",Le,[a("a",{href:l.link,target:"_blank",class:"wiki-link"},[...e[15]||(e[15]=[a("i",{class:"pi pi-book"},null,-1),b(" Ver en wiki ",-1)])],8,Ue),i.value[l.version]?.link?(t(),n("a",{key:0,href:i.value[l.version]?.link,target:"_blank",class:"official-link"},[...e[16]||(e[16]=[a("i",{class:"pi pi-globe"},null,-1),b(" Nota oficial ",-1)])],8,Re)):x("",!0)])])])])]),_:2},1024))),128))],4))])]),_:1}),d(X,{name:"fade"},{default:k(()=>[R.value?(t(),n("button",{key:0,onClick:O,class:"scroll-top-button"},[...e[18]||(e[18]=[a("i",{class:"pi pi-arrow-up"},null,-1)])])):x("",!0)]),_:1})],64))}}),Ee=ee(Ae,[["__scopeId","data-v-3d074650"]]);export{Ee as default};
