var e=e=>{let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{t.append(e,n.toString())}),`https://nomanssky.fandom.com/api.php?${t.toString()}`},t={format:`json`,origin:`*`};const n=(n,r,i)=>{let a={...t,action:`cargoquery`,tables:`Bases`,fields:[`Name`,`CensusPlayer`,`CensusReddit`,`CensusDiscord`,`CensusFriend`,`System`,`Platform`,`Mode`,`CensusArrival`,`CensusRenewal`,`Builderlink`].join(`,`),where:`CensusShow IS NOT NULL AND Civilized='${n}'${i?` AND CensusRenewal HOLDS ${i}`:``}`,order_by:`CensusRenewal DESC`,group_by:`CensusPlayer`,limit:500,offset:r};return e(a)},r=async e=>{try{let t=await fetch(e);if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);let n=await t.text(),r=i(n);return JSON.parse(r)}catch(e){throw console.error(`API call failed:`,e),e}};var i=e=>e.replace(/&lt;/g,`<`).replace(/&gt;/g,`>`).replace(/&quot;/g,`"`).replace(/&#039;/g,`'`).replace(/&amp;/g,`&`);const a=e=>e.cargoquery.map(({title:e})=>({Name:e.Name,_pageName:e._pageName||e.Name,CensusPlayer:e.CensusPlayer||`Desconocido`,System:e.System||`Desconocido`,Platform:e.Platform||`Desconocida`,Mode:e.Mode||`Desconocido`,CensusArrival:e.CensusArrival||`Desconocido`,CensusRenewal:e.CensusRenewal||`Desconocido`,Builderlink:e.Builderlink,CensusReddit:e.CensusReddit,CensusDiscord:e.CensusDiscord,CensusFriend:e.CensusFriend,CensusVerified:e.CensusVerified})),o=async(e,t,i)=>{let o=n(e,t,i),s=await r(o);if(!s?.cargoquery)throw Error(`Invalid API response structure`);return a(s)},s=async n=>{let i={...t,action:`parse`,page:n,prop:`wikitext`},a=e(i),o=((await r(a))?.parse?.wikitext?.[`*`]||``).match(/\|\s*image\s*=\s*(.+)/i);return o?o[1].split(`
`)[0].split(`|`)[0].trim():null},c=async n=>{n.toLowerCase().startsWith(`file:`)||(n=`File:`+n);let i={...t,action:`query`,titles:n,prop:`imageinfo`,iiprop:`url`},a=e(i),o=(await r(a))?.query?.pages;if(o){let e=Object.keys(o)[0],t=o[e];if(t&&t.imageinfo&&t.imageinfo[0]){let e=t.imageinfo[0].url,n=e.split(`/revision`)[0],r=e.split(`revision`)[0];return{panel:n,modal:r}}}return null},l=async e=>{let t=await s(e);return t?await c(t):null},u=(n,r=0)=>{let i={...t,action:`cargoquery`,tables:`Regions`,fields:[`Regions.Coordinates`,`Regions.Galaxy`,`Regions.Quadrant`,`Regions.Civilized`,`_pageName=Region`].join(`,`),where:`Civilized='${n}'`,order_by:`Region ASC`,offset:r};return e(i)},d=e=>e.cargoquery.map(({title:e})=>({Coordinates:e.Coordinates||`Desconocido`,Galaxy:e.Galaxy||`Desconocido`,Quadrant:e.Quadrant||`Desconocido`,Civilized:e.Civilized||`Desconocido`,Region:e.Region||`Desconocido`})),f=async(e,t=0)=>{let n=u(e,t),i=await r(n);if(!i?.cargoquery)throw Error(`Invalid API response structure`);return d(i)},p=async n=>{let i={...t,action:`parse`,page:n,prop:`wikitext`},a=e(i),o=((await r(a))?.parse?.wikitext?.[`*`]||``).match(/\|\s*image\s*=\s*(.+)/i);return o?o[1].split(`
`)[0].split(`|`)[0].trim():null},m=async n=>{n.toLowerCase().startsWith(`file:`)||(n=`File:`+n);let i={...t,action:`query`,titles:n,prop:`imageinfo`,iiprop:`url`},a=e(i),o=(await r(a))?.query?.pages;if(o){let e=Object.keys(o)[0],t=o[e];if(t&&t.imageinfo&&t.imageinfo[0]){let e=t.imageinfo[0].url,n=e.split(`/revision`)[0],r=e.split(`revision`)[0];return{panel:n,modal:r}}}return null},h=async e=>{let t=await p(e);return t?await m(t):null};var g=async(n,i,a)=>{try{let o={...t,action:`cargoquery`,tables:i,fields:[a].join(`,`),where:`Civilized='Royal Space Society' AND Region='${n}'`,limit:500},s=e(o),c=await r(s);return c?.cargoquery&&Array.isArray(c.cargoquery)?c.cargoquery.length:null}catch(e){return console.error(`Error fetching category stats for ${n}:`,e),null}};const _=async e=>{let t={"Star systems":{CrossPlatform:0},Bases:{CrossPlatform:0},Planets:{CrossPlatform:0},Fauna:{CrossPlatform:0},Starships:{CrossPlatform:0},"Multi-Tools":{CrossPlatform:0}};for(let[n,{tableClass:r,tableFields:i}]of Object.entries({"Star systems":{tableClass:`Systems`,tableFields:`Region`},Bases:{tableClass:`Bases`,tableFields:`Name`},Planets:{tableClass:`Planets`,tableFields:`Civilized`},Fauna:{tableClass:`Creatures`,tableFields:`Name`},Starships:{tableClass:`Starships`,tableFields:`Coordinates`},"Multi-Tools":{tableClass:`Multitools`,tableFields:`Civilized`}})){let a=await g(e,r,i);a!==null&&(t[n]={CrossPlatform:a})}return Object.keys(t).length>0?t:null};export{m as a,f as i,o as n,_ as o,h as r,l as t};