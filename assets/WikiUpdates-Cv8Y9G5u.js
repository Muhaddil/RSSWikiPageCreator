import{A as e,B as t,M as n,U as r,W as i,d as a,dt as o,f as s,h as c,i as ee,j as l,k as u,l as d,m as te,p as ne,st as f,t as re,tt as p,ut as m,v as h,x as ie,y as g}from"./runtime-dom.esm-bundler-DVzMal_p.js";import"./button-Bw1EBTQH.js";import"./portal-BI2jNyMm.js";import"./dist-BmVmG--T.js";import{t as ae}from"./ThemeSwitch-clVHOxw7.js";import"./baseinput-B4lj0bez.js";import{t as oe}from"./inputtext-CdlTGRqd.js";import{t as _}from"./_plugin-vue_export-helper-D6098ZHW.js";import"./iconfield-BZqOluU5.js";import"./select-BbX3h9RX.js";import"./check-u4TQaBxG.js";import"./chevrondown-BWeRyKaq.js";import{t as v}from"./card-BdxbRywI.js";import"./minus-BzWp2jKH.js";import{t as se}from"./panel-GWWEmbYa.js";import{t as y}from"./logo-white-CAp0XnaH.js";import{t as ce}from"./tag-GvdDxJZh.js";import{t as le}from"./dropdown-07oc_JVg.js";var b={class:`space-page-container`},x={class:`flex items-start justify-between mb-6 header-container`},S={class:`flex flex-col`},C={class:`header-container`},w={class:`title-theme-container`},T={class:`galactic-title`},E={class:`title-text`},D={class:`text-stellar-gray mt-2`},O={class:`text-stellar-gray mt-2`},k={class:`filter-container mb-6 p-4 bg-space-dark rounded-lg`},A={class:`grid grid-cols-1 md:grid-cols-2 gap-4`},j={class:`flex`},M={class:`block mb-2`},N={class:`panel-content`},P={class:`update-info mt-2`},F={key:0,class:`loading-message`},I={key:1,class:`error-message p-error`},L={class:`p-4`},R={class:`flex flex-column gap-3`},z={class:`flex align-items-center gap-2`},ue={class:`update-title`},B={class:`update-details`},V={class:`detail-item`},H={class:`detail-value`},U={class:`detail-item`},de={class:`detail-value`},fe={class:`comment-box mt-3 p-3 bg-space-light rounded`},pe={class:`mt-1`},me={class:`mt-3`},he=[`href`],ge=[`href`],W=_(ie({__name:`WikiUpdates`,setup(ie){let _=p([]),y=p(!0),W=p(null),G=p(window.innerWidth),K=p(500),q=p(``),J=p(!1),Y=p(!1),_e=navigator.userAgent.includes(`Chrome`),ve=a(()=>G.value<768?1:G.value<1200?2:3),ye=a(()=>J.value?`https://nomanssky.fandom.com/api.php`:`https://nomanssky.fandom.com/es/api.php`),X=p([{value:25,label:`25 resultados`},{value:50,label:`50 resultados`},{value:100,label:`100 resultados`},{value:200,label:`200 resultados`},{value:300,label:`300 resultados`},{value:400,label:`400 resultados`},{value:500,label:`500 resultados`}]),Z=async()=>{try{y.value=!0,W.value=null;let e=new URLSearchParams({action:`query`,list:`recentchanges`,rcprop:`title|timestamp|user|comment|ids|flags|loginfo|revid|old_revid`,rclimit:K.value.toString(),rcshow:`!bot`,rcdir:`older`,format:`json`,origin:`*`,...q.value&&{rcuser:q.value}}),t=await fetch(`${ye.value}?${e.toString()}`);if(!t.ok)throw Error(`Error en la API de la wiki`);let n=await t.json();if(n.error)throw Error(n.error.info);_.value=n.query.recentchanges.map(e=>({title:e.title,timestamp:e.timestamp,user:e.user,comment:e.comment||`(sin comentario)`,pageid:e.pageid,revid:e.revid,old_revid:e.old_revid}))}catch(e){W.value=`Error al cargar actualizaciones`,console.error(e)}finally{y.value=!1}};u(async()=>{window.addEventListener(`resize`,()=>G.value=window.innerWidth),await Z()}),t(J,()=>{Z()}),t(K,()=>{Z()});let Q=e=>e.trim().replace(/\s+/g,`_`).replace(/\//g,`_`),be=e=>{let t=new Date,n=new Date(e),r=t.getTime()-n.getTime(),i=Math.floor(r/6e4);if(i<60)return`Hace ${i} min`;let a=Math.floor(i/60);return a<24?`Hace ${a} h`:`Hace ${Math.floor(a/24)} días`},xe=e=>new Date(e).toLocaleString(`es-ES`,{year:`numeric`,month:`long`,day:`numeric`,hour:`2-digit`,minute:`2-digit`,second:`2-digit`}),$=()=>{Y.value=window.scrollY>300},Se=()=>{window.scrollTo({top:0,behavior:`smooth`})};return u(()=>{window.addEventListener(`scroll`,$)}),e(()=>{window.removeEventListener(`scroll`,$)}),(e,t)=>(l(),c(d,null,[g(f(v),{class:`p-0 galactic-card`},{content:r(()=>[s(`div`,b,[s(`div`,x,[s(`div`,S,[t[3]||=s(`a`,{href:`https://nomanssky.fandom.com/es/wiki/Royal_Space_Society`,target:`_blank`},[s(`div`,{class:`wiki-logo`},[s(`img`,{src:`/RSSWikiPageCreator/assets/images/shared/logo-white.png`,class:`logo-image`,alt:`Wiki Logo`})])],-1),s(`div`,C,[s(`div`,w,[s(`h1`,T,[s(`span`,E,`Actualizaciones Recientes - Wiki `+o(J.value?`EN`:`ES`),1)])])]),s(`p`,D,` Últimos cambios en la wiki `+o(J.value?`inglesa`:`española`)+` de No Man's Sky `,1)]),s(`p`,O,[g(ae,{style:{"margin-right":`2rem`}})])]),s(`div`,k,[s(`div`,A,[s(`div`,null,[t[4]||=s(`label`,{class:`block mb-6 text-stellar-blue font-medium`},`Resultados:`,-1),g(f(le),{modelValue:K.value,"onUpdate:modelValue":t[0]||=e=>K.value=e,options:X.value,optionLabel:`label`,optionValue:`value`,class:`w-full ml-2`,pt:{root:{class:`bg-space-light border-space-blue`},input:{class:`text-stellar-light`},trigger:{class:`bg-space-blue`}}},null,8,[`modelValue`,`options`])]),s(`div`,null,[t[5]||=s(`label`,{class:`block mb-2`},`Filtrar por usuario:`,-1),s(`div`,j,[g(f(oe),{modelValue:q.value,"onUpdate:modelValue":t[1]||=e=>q.value=e,placeholder:`Nombre de usuario`,class:`w-full`},null,8,[`modelValue`]),s(`button`,{onClick:Z,class:`p-button p-component ml-2`},` Buscar `)])])]),s(`div`,null,[s(`label`,M,[i(s(`input`,{type:`checkbox`,"onUpdate:modelValue":t[2]||=e=>J.value=e,class:`mr-2`},null,512),[[ee,J.value]]),t[6]||=h(` Consultar wiki en inglés `,-1)])])]),g(f(se),{class:`galactic-panel`},{header:r(()=>[...t[7]||=[s(`h2`,{class:`panel-title`},`Información de Actualizaciones`,-1)]]),default:r(()=>[s(`div`,N,[s(`p`,null,[t[8]||=h(` Total de cambios recientes: `,-1),s(`strong`,null,o(_.value.length),1)]),s(`p`,P,`Actualizado: `+o(new Date().toLocaleString(`es-ES`)),1)])]),_:1}),t[17]||=s(`br`,null,null,-1),y.value?(l(),c(`div`,F,[...t[9]||=[s(`i`,{class:`pi pi-spinner pi-spin`},null,-1),h(` Cargando actualizaciones... `,-1)]])):W.value?(l(),c(`div`,I,[t[10]||=s(`i`,{class:`pi pi-exclamation-triangle`},null,-1),h(` `+o(W.value),1)])):(l(),c(`div`,{key:2,class:`grid gap-4`,style:m(`grid-template-columns: repeat(${f(ve)}, 1fr)`)},[(l(!0),c(d,null,n(_.value,(e,n)=>(l(),ne(f(v),{key:n,class:`update-card`,style:m(f(_e)?{width:`32.5vh`}:{})},{content:r(()=>[s(`div`,L,[s(`div`,R,[s(`div`,z,[s(`h3`,ue,o(e.title),1),g(f(ce),{value:be(e.timestamp),severity:`info`,class:`time-tag`},null,8,[`value`])]),s(`div`,B,[s(`div`,V,[t[11]||=s(`span`,{class:`detail-label`},`Usuario:`,-1),s(`span`,H,o(e.user),1)]),s(`div`,U,[t[12]||=s(`span`,{class:`detail-label`},`Fecha:`,-1),s(`span`,de,o(xe(e.timestamp)),1)]),s(`div`,fe,[t[13]||=s(`span`,{class:`detail-label`},`Comentario:`,-1),s(`p`,pe,o(e.comment),1)])]),s(`div`,me,[s(`a`,{href:`https://nomanssky.fandom.com/${J.value?``:`es/`}wiki/${Q(e.title)}`,target:`_blank`,class:`wiki-link`},[...t[14]||=[s(`i`,{class:`pi pi-external-link`},null,-1),h(` Ver página en la wiki `,-1)]],8,he),t[16]||=s(`span`,{class:`mx-2`},`|`,-1),s(`a`,{href:`https://nomanssky.fandom.com/${J.value?``:`es/`}wiki/${Q(e.title)}?diff=${e.revid}&oldid=${e.old_revid}`,target:`_blank`,class:`wiki-link`},[...t[15]||=[s(`i`,{class:`pi pi-history`},null,-1),h(` Ver cambios `,-1)]],8,ge)])])])]),_:2},1032,[`style`]))),128))],4))])]),_:1}),g(re,{name:`fade`},{default:r(()=>[Y.value?(l(),c(`button`,{key:0,onClick:Se,class:`scroll-top-button`},[...t[18]||=[s(`i`,{class:`pi pi-arrow-up`},null,-1)]])):te(``,!0)]),_:1})],64))}}),[[`__scopeId`,`data-v-238370a7`]]);export{W as default};