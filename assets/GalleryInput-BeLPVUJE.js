import{u as N,d as le,I as ae,e as te,E as H,f as se,b as A,S as oe}from"./main-CmHG7xNP.js";import{s as O}from"./pinia-DTMVEOtY.js";import{_ as L,c as y,b as r,Q as I,d as l,R as U,F as w,x as a,q as C,a3 as ie,a4 as ne,r as S,O as m,K as b,E as v,U as re,J as D,N as ue,M as j,L as G,D as de,I as T,W as B,i as me}from"./@vue-AaAR792z.js";import{a as J,o as pe,e as K,p as q,k as Q,s as W}from"./primevue-B5xHOMrV.js";import{e as ce,w as fe,g as X,d as R}from"./@vueuse-CeyP63Rz.js";import{d as ve}from"./debounce-B7UkYTDg.js";import{l as ge}from"./vue-draggable-plus-C12-0fai.js";const We="Royal Space Society",Re=L({__name:"GalleryOutput",props:{fileList:{}},setup(x){const h=N(),{galleryFiles:u}=O(h);return(s,n)=>(r(),y(I,null,[n[0]||(n[0]=l("div",null,"<gallery>",-1)),(r(!0),y(I,null,U(s.fileList??a(u),c=>(r(),y("div",{key:c.id},w(c.file.name)+w(c.desc?"|":"")+w(c.desc),1))),128)),n[1]||(n[1]=l("div",null,"</gallery>",-1))],64))}}),E=1e7,be="https://nomanssky.fandom.com/wiki/",ye=["href"],Y=L({__name:"WikiLink",props:{link:{},text:{}},setup(x){const h=x,u=C(()=>be+h.link);return(s,n)=>(r(),y("a",{href:u.value,rel:"noopener noreferrer",target:"_blank"},w(s.text),9,ye))}}),he={class:"is-flex is-justify-content-space-between is-align-items-center full-width"},ke=["for"],Se=200,xe=L({__name:"SingleFileUpload",props:ie({label:{},tooltip:{},helpImg:{},helpTitle:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const h=ne(x,"modelValue"),u=S(!1),s=S(!1),n=S(!0),c=C(()=>s.value||!n.value);ce(document,"reset",()=>s.value=!1),fe(h,p=>n.value=!p||p.includes("."),{debounce:ve});const g=S(localStorage.getItem("hasSeenInfoModal")==="true");function f(p){const i=p.files[0];i instanceof File&&(g.value||(u.value=!0,g.value=!0,localStorage.setItem("hasSeenInfoModal","true")),$([i]))}function $(p){const i=p==null?void 0:p[0];if(!i)return;const P=i.size>E;if(s.value=P,P)return;const ee=i.name;h.value=ee}const _=le("file-upload-"),o=S(null),t=S(null),e=S(),{isOverDropZone:d}=X(o,{onDrop:$,dataTypes:p=>p.every(i=>i.startsWith("image/")),multiple:!1,preventDefaultForUnhandled:!0}),{height:k}=R(e),F=C(()=>k.value/2),{width:V}=R(t),M=C(()=>V.value<=Se);return(p,i)=>(r(),y("div",{ref_key:"dropzone",ref:o},[m(ae,null,{label:b(()=>[l("div",he,[l("label",{for:a(_)},w(p.label),9,ke),p.tooltip?(r(),D(se,{key:0,"help-img":p.helpImg,"help-title":p.helpTitle,tooltip:p.tooltip},{default:b(()=>[de(p.$slots,"default",{},void 0,!0)]),_:3},8,["help-img","help-title","tooltip"])):G("",!0)])]),input:b(()=>[l("div",{ref_key:"inputWrapper",ref:t},[m(a(J),{visible:u.value,"onUpdate:visible":i[0]||(i[0]=z=>u.value=z),modal:"",header:"Atención",closable:!0},{default:b(()=>[l("span",null,[i[2]||(i[2]=v(" No olvides subir tu foto a la wiki en ")),m(Y,{link:"Special:Upload?multiple=true",text:"Especial:Subir"}),i[3]||(i[3]=v(". El botón de carga solo completa automáticamente el nombre de la imagen en el código, no se carga automáticamente en la wiki. "))]),i[4]||(i[4]=l("div",{class:"mt-3"},[l("span",{class:"has-text-weight-bold"},"NOTA"),v(': Puede acceder a esta ventana emergente en cualquier momento haciendo clic en "?" junto al botón de carga de la imagen principal. ')],-1))]),_:1,__:[4]},8,["visible"]),m(te,{invalid:c.value,top:`${F.value}px`,"move-left":M.value?void 0:"5.5rem"},re({default:b(()=>[(r(),D(ue(M.value?"div":a(pe)),{class:j({"is-flex is-flex-direction-column is-gap-1":M.value})},{default:b(()=>[m(a(K),{modelValue:h.value,"onUpdate:modelValue":i[1]||(i[1]=z=>h.value=z),id:a(_),invalid:c.value,ref_key:"textInput",ref:e,size:"small"},null,8,["modelValue","id","invalid"]),m(a(q),{class:j([{"p-button-outlined":!a(d)},"p-button-sm upload-button"]),accept:"image/*",mode:"basic",auto:"","custom-upload":"",chooseLabel:"Elegir",onSelect:f},null,8,["class"])]),_:1},8,["class"]))]),_:2},[s.value?{name:"errorMessage",fn:b(()=>[i[5]||(i[5]=v(" Este archivo es demasiado grande para subirlo a la wiki. El tamaño máximo es de 10 MB. Comprime tu archivo aquí: ")),m(H,{link:"https://nmscd.com/Image-Compressor/",text:"Compresor de imágenes"})]),key:"0"}:n.value?void 0:{name:"errorMessage",fn:b(()=>[i[6]||(i[6]=v("¡El archivo no tiene extensión de archivo (es decir, .jpg, .png)!"))]),key:"1"}]),1032,["invalid","top","move-left"])],512)]),_:3})],512))}}),Ze=A(xe,[["__scopeId","data-v-6ab78c51"]]),Ie={class:"gallery-wrapper is-flex full-width"},we=["href"],_e=["alt","src"],Fe={class:"input-section is-flex is-flex-direction-column is-flex-grow-1 is-gap-1 p-2"},$e={style:{"word-break":"break-all"}},De={class:"is-flex is-flex-direction-column is-justify-content-space-between is-align-items-center is-gap-1 p-2 ml-auto"},Le={class:"handle pi pi-arrows-v",title:"Mover la imagen hacia arriba o hacia abajo",draggable:"true"},Me={class:"button-wrapper is-flex-direction-column is-gap-1"},Ee=L({__name:"GalleryItem",props:{fileItem:{},isLocationFile:{type:Boolean}},setup(x){const h=x,u=N(),{galleryFiles:s,locationFiles:n,galleryDescriptions:c}=O(u),g=URL.createObjectURL(h.fileItem.file);function f(o){s.value=s.value.filter(t=>t!==o),n.value=n.value.filter(t=>t!==o)}function $(o,t){const e=s.value.indexOf(o),d=n.value.indexOf(o),k=(()=>{if(e!==-1)return s;if(d!==-1)return n;throw new Error("Couldn't find item!")})(),F=k.value.indexOf(o);if(t==="up"&&F)k.value.splice(F-1,0,o),k.value.splice(F+1,1);else if(t==="down"&&F!==k.value.length-1){const V=k.value.filter(M=>M!==o);V.splice(F+1,0,o),k.value=V}}const _=["up","down"];return(o,t)=>(r(),D(a(Q),{class:"gallery-item"},{default:b(()=>[l("div",Ie,[l("a",{class:"gallery-media is-flex is-unselectable is-justify-content-center",href:a(g),target:"_blank",rel:"noopener noreferrer"},[l("img",{alt:o.fileItem.file.name,src:a(g),class:"mx-auto"},null,8,_e)],8,we),l("div",Fe,[l("p",$e,[t[3]||(t[3]=l("span",{class:"has-text-weight-bold"},"Nombre: ",-1)),v(w(o.fileItem.file.name),1)]),T(l("div",null,[m(oe,{modelValue:o.fileItem.desc,"onUpdate:modelValue":t[0]||(t[0]=e=>o.fileItem.desc=e),options:a(c)},null,8,["modelValue","options"])],512),[[B,a(c).length]]),l("div",null,[m(a(K),{modelValue:o.fileItem.desc,"onUpdate:modelValue":t[1]||(t[1]=e=>o.fileItem.desc=e),placeholder:"Descripción",size:"small"},null,8,["modelValue"])])]),l("div",De,[m(a(W),{class:"delete-icon is-clickable",severity:"danger",title:"Eliminar imagen de la galería",onClick:t[2]||(t[2]=e=>f(o.fileItem))},{default:b(()=>t[4]||(t[4]=[v(" ❌ ")])),_:1,__:[4]}),T(l("span",Le,null,512),[[B,!o.isLocationFile]]),l("div",Me,[(r(),y(I,null,U(_,e=>T(m(a(W),{icon:`pi pi-sort-${e}-fill`,title:`Mover ${e}`,severity:"secondary",outlined:"",onClick:d=>$(o.fileItem,e)},null,8,["icon","title","onClick"]),[[B,!o.isLocationFile]])),64))])])])]),_:1}))}}),Z=A(Ee,[["__scopeId","data-v-3654535c"]]),Ue={key:0,class:"is-flex is-flex-direction-column is-gap-1"},Ve=L({__name:"GalleryPreview",setup(x){const h=N(),{galleryFiles:u,locationFiles:s}=O(h),n=S(!1);return(c,g)=>a(u).length?(r(),D(a(Q),{key:0,collapsed:n.value,"onUpdate:collapsed":g[1]||(g[1]=f=>n.value=f),header:"Vistra Previa",toggleable:""},{default:b(()=>[m(a(ge),{modelValue:a(u),"onUpdate:modelValue":g[0]||(g[0]=f=>me(u)?u.value=f:null),animation:250,class:"is-flex is-flex-direction-column is-gap-1",handle:".handle"},{default:b(()=>[(r(!0),y(I,null,U(a(u),f=>(r(),D(Z,{"file-item":f,key:f.id,"is-location-file":!1},null,8,["file-item"]))),128))]),_:1},8,["modelValue"]),a(s).length?(r(),y("div",Ue,[g[2]||(g[2]=l("p",{class:"has-text-weight-bold is-block mb-1"},"Location Files",-1)),(r(!0),y(I,null,U(a(s),f=>(r(),D(Z,{"file-item":f,key:f.id,"is-location-file":!0},null,8,["file-item"]))),128))])):G("",!0)]),_:1},8,["collapsed"])):G("",!0)}}),ze={class:"is-flex is-flex-direction-column is-gap-2 mt-5"},Ce={key:0,class:"error-message"},Ge={class:"mt-3"},Ne=L({__name:"GalleryInput",setup(x){const h=N(),{galleryFiles:u}=O(h),s=S([]),n=S(!1),c=S(localStorage.getItem("hasSeenInfoModal-Gallery")==="true");let g=0;function f(t){const e=t.files;if(!Array.isArray(e))return;s.value=[];const d=e.filter(k=>k instanceof File?k.size>E?(s.value.push(k.name),!1):!0:!1).map(k=>({file:k,id:g++,desc:""}));!c.value&&d.length&&(n.value=!0,c.value=!0,localStorage.setItem("hasSeenInfoModal-Gallery","true")),d.length&&u.value.unshift(...d)}function $(t){if(!t)return;s.value=[];const e=t.filter(d=>d.size>E?(s.value.push(d.name),!1):!0).map(d=>({file:d,id:g++,desc:""}));!c.value&&e.length&&(n.value=!0,c.value=!0,localStorage.setItem("hasSeenInfoModal-Gallery","true")),e.length&&u.value.unshift(...e)}const _=S(null),{isOverDropZone:o}=X(_,{onDrop:$,dataTypes:t=>t.every(e=>e.startsWith("image/")),multiple:!0,preventDefaultForUnhandled:!0});return(t,e)=>(r(),y("div",ze,[s.value.length?(r(),y("p",Ce,[s.value.length===1?(r(),y(I,{key:0},[e[1]||(e[1]=v(" El archivo ")),l("strong",null,w(s.value[0]),1),e[2]||(e[2]=v(" es demasiado grande para subirlo (máx. 10MB). "))],64)):(r(),y(I,{key:1},[e[3]||(e[3]=v(" Los siguientes archivos son demasiado grandes para subirlos (máx. 10MB): ")),l("ul",null,[(r(!0),y(I,null,U(s.value,d=>(r(),y("li",{key:d},w(d),1))),128))])],64)),e[4]||(e[4]=v(" Comprime tu archivo aquí: ")),m(H,{link:"https://nmscd.com/Image-Compressor/",text:"Compresor de imágenes"})])):G("",!0),m(a(q),{maxFileSize:a(E),"show-cancel-button":!1,"show-upload-button":!1,accept:"image/*",auto:"","custom-upload":"",multiple:"",onSelect:f},{header:b(()=>[l("div",{class:"full-width",ref_key:"dropzone",ref:_},[m(a(q),{class:j({"p-button-outlined":!a(o)}),maxFileSize:a(E),accept:"image/*","choose-label":"Añadir archivos",auto:"","custom-upload":"",mode:"basic",multiple:"",onSelect:f},null,8,["class","maxFileSize"])],512)]),empty:b(()=>e[5]||(e[5]=[l("div",{class:"is-flex is-justify-content-center is-align-items-center my-5"},[l("p",null,"Suelte los archivos de la galería aquí")],-1)])),_:1},8,["maxFileSize"]),m(a(J),{visible:n.value,"onUpdate:visible":e[0]||(e[0]=d=>n.value=d),modal:"",header:"Atención",closable:!0},{default:b(()=>[e[8]||(e[8]=l("span",null,[v(" Las imágenes seleccionadas "),l("strong",null,"no se subirán automáticamente"),v(" a la wiki. Este selector solo agrega las imágenes al formulario actual. ")],-1)),l("div",Ge,[e[6]||(e[6]=v(" Para subir imágenes a la wiki, ve a ")),m(Y,{link:"Special:Upload?multiple=true",text:"Especial:Subir"}),e[7]||(e[7]=v(" y súbelas manualmente. "))]),e[9]||(e[9]=l("div",{class:"mt-3"},[l("span",{class:"has-text-weight-bold"},"NOTA"),v(": Las imágenes agregadas aquí deben el mismo nombre que las que subas a la wiki. Si no, el formulario completará automáticamente el nombre de la imagen incorrectamente. ")],-1))]),_:1,__:[8,9]},8,["visible"]),m(Ve)]))}}),He=A(Ne,[["__scopeId","data-v-8f8c2b8a"]]);export{He as G,Ze as S,Re as _,We as c};
