import{u as N,d as le,I as ae,e as te,E as H,f as se,b as A,S as oe}from"./main-BRDP8-q1.js";import{s as O}from"./pinia-DTMVEOtY.js";import{_ as L,c as y,b as r,Q as I,d as l,R as U,F as w,x as a,q as C,a3 as ie,a4 as ne,r as S,O as m,K as b,E as v,U as re,J as D,N as ue,M as j,L as G,D as de,I as T,W as B,i as me}from"./@vue-AaAR792z.js";import{a as J,o as pe,e as K,p as q,k as Q,s as W}from"./primevue-B5xHOMrV.js";import{e as ce,w as fe,g as X,d as R}from"./@vueuse-CeyP63Rz.js";import{d as ve}from"./debounce-B7UkYTDg.js";import{l as ge}from"./vue-draggable-plus-C12-0fai.js";const We="Royal Space Society",Re=L({__name:"GalleryOutput",props:{fileList:{}},setup(e){const i=N(),{galleryFiles:s}=O(i);return(e,i)=>(r(),y(I,null,[i[0]||(i[0]=l("div",null,"<gallery>",-1)),(r(!0),y(I,null,U(e.fileList??a(s),(e=>(r(),y("div",{key:e.id},w(e.file.name)+w(e.desc?"|":"")+w(e.desc),1)))),128)),i[1]||(i[1]=l("div",null,"</gallery>",-1))],64))}}),E=1e7,be="https://nomanssky.fandom.com/wiki/",ye=["href"],Y=L({__name:"WikiLink",props:{link:{},text:{}},setup(e){const l=e,a=C((()=>be+l.link));return(e,l)=>(r(),y("a",{href:a.value,rel:"noopener noreferrer",target:"_blank"},w(e.text),9,ye))}}),he={class:"is-flex is-justify-content-space-between is-align-items-center full-width"},ke=["for"],Se=200,xe=L({__name:"SingleFileUpload",props:ie({label:{},tooltip:{},helpImg:{},helpTitle:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const i=ne(e,"modelValue"),s=S(!1),t=S(!1),o=S(!0),n=C((()=>t.value||!o.value));ce(document,"reset",(()=>t.value=!1)),fe(i,(e=>o.value=!e||e.includes(".")),{debounce:ve});const u=S("true"===localStorage.getItem("hasSeenInfoModal"));function c(e){const l=e.files[0];l instanceof File&&(u.value||(s.value=!0,u.value=!0,localStorage.setItem("hasSeenInfoModal","true")),d([l]))}function d(e){const l=null==e?void 0:e[0];if(!l)return;const a=l.size>E;if(t.value=a,a)return;const s=l.name;i.value=s}const p=le("file-upload-"),f=S(null),g=S(null),h=S(),{isOverDropZone:x}=X(f,{onDrop:d,dataTypes:e=>e.every((e=>e.startsWith("image/"))),multiple:!1,preventDefaultForUnhandled:!0}),{height:k}=R(h),_=C((()=>k.value/2)),{width:I}=R(g),U=C((()=>I.value<=Se));return(e,u)=>(r(),y("div",{ref_key:"dropzone",ref:f},[m(ae,null,{label:b((()=>[l("div",he,[l("label",{for:a(p)},w(e.label),9,ke),e.tooltip?(r(),D(se,{key:0,"help-img":e.helpImg,"help-title":e.helpTitle,tooltip:e.tooltip},{default:b((()=>[de(e.$slots,"default",{},void 0,!0)])),_:3},8,["help-img","help-title","tooltip"])):G("",!0)])])),input:b((()=>[l("div",{ref_key:"inputWrapper",ref:g},[m(a(J),{visible:s.value,"onUpdate:visible":u[0]||(u[0]=e=>s.value=e),modal:"",header:"Atención",closable:!0},{default:b((()=>[l("span",null,[u[2]||(u[2]=v(" No olvides subir tu foto a la wiki en ")),m(Y,{link:"Special:Upload?multiple=true",text:"Especial:Subir"}),u[3]||(u[3]=v(". El botón de carga solo completa automáticamente el nombre de la imagen en el código, no se carga automáticamente en la wiki. "))]),u[4]||(u[4]=l("div",{class:"mt-3"},[l("span",{class:"has-text-weight-bold"},"NOTA"),v(': Puede acceder a esta ventana emergente en cualquier momento haciendo clic en "?" junto al botón de carga de la imagen principal. ')],-1))])),_:1,__:[4]},8,["visible"]),m(te,{invalid:n.value,top:`${_.value}px`,"move-left":U.value?void 0:"5.5rem"},re({default:b((()=>[(r(),D(ue(U.value?"div":a(pe)),{class:j({"is-flex is-flex-direction-column is-gap-1":U.value})},{default:b((()=>[m(a(K),{modelValue:i.value,"onUpdate:modelValue":u[1]||(u[1]=e=>i.value=e),id:a(p),invalid:n.value,ref_key:"textInput",ref:h,size:"small"},null,8,["modelValue","id","invalid"]),m(a(q),{class:j([{"p-button-outlined":!a(x)},"p-button-sm upload-button"]),accept:"image/*",mode:"basic",auto:"","custom-upload":"",chooseLabel:"Elegir",onSelect:c},null,8,["class"])])),_:1},8,["class"]))])),_:2},[t.value?{name:"errorMessage",fn:b((()=>[u[5]||(u[5]=v(" Este archivo es demasiado grande para subirlo a la wiki. El tamaño máximo es de 10 MB. Comprime tu archivo aquí: ")),m(H,{link:"https://nmscd.com/Image-Compressor/",text:"Compresor de imágenes"})])),key:"0"}:o.value?void 0:{name:"errorMessage",fn:b((()=>[u[6]||(u[6]=v("¡El archivo no tiene extensión de archivo (es decir, .jpg, .png)!"))])),key:"1"}]),1032,["invalid","top","move-left"])],512)])),_:3})],512))}}),Ze=A(xe,[["__scopeId","data-v-6ab78c51"]]),Ie={class:"gallery-wrapper is-flex full-width"},we=["href"],_e=["alt","src"],Fe={class:"input-section is-flex is-flex-direction-column is-flex-grow-1 is-gap-1 p-2"},$e={style:{"word-break":"break-all"}},De={class:"is-flex is-flex-direction-column is-justify-content-space-between is-align-items-center is-gap-1 p-2 ml-auto"},Le={class:"handle pi pi-arrows-v",title:"Mover la imagen hacia arriba o hacia abajo",draggable:"true"},Me={class:"button-wrapper is-flex-direction-column is-gap-1"},Ee=L({__name:"GalleryItem",props:{fileItem:{},isLocationFile:{type:Boolean}},setup(e){const i=e,s=N(),{galleryFiles:t,locationFiles:o,galleryDescriptions:n}=O(s),u=URL.createObjectURL(i.fileItem.file);const c=["up","down"];return(e,i)=>(r(),D(a(Q),{class:"gallery-item"},{default:b((()=>[l("div",Ie,[l("a",{class:"gallery-media is-flex is-unselectable is-justify-content-center",href:a(u),target:"_blank",rel:"noopener noreferrer"},[l("img",{alt:e.fileItem.file.name,src:a(u),class:"mx-auto"},null,8,_e)],8,we),l("div",Fe,[l("p",$e,[i[3]||(i[3]=l("span",{class:"has-text-weight-bold"},"Nombre: ",-1)),v(w(e.fileItem.file.name),1)]),T(l("div",null,[m(oe,{modelValue:e.fileItem.desc,"onUpdate:modelValue":i[0]||(i[0]=l=>e.fileItem.desc=l),options:a(n)},null,8,["modelValue","options"])],512),[[B,a(n).length]]),l("div",null,[m(a(K),{modelValue:e.fileItem.desc,"onUpdate:modelValue":i[1]||(i[1]=l=>e.fileItem.desc=l),placeholder:"Descripción",size:"small"},null,8,["modelValue"])])]),l("div",De,[m(a(W),{class:"delete-icon is-clickable",severity:"danger",title:"Eliminar imagen de la galería",onClick:i[2]||(i[2]=l=>function(e){t.value=t.value.filter((l=>l!==e)),o.value=o.value.filter((l=>l!==e))}(e.fileItem))},{default:b((()=>i[4]||(i[4]=[v(" ❌ ")]))),_:1,__:[4]}),T(l("span",Le,null,512),[[B,!e.isLocationFile]]),l("div",Me,[(r(),y(I,null,U(c,(l=>T(m(a(W),{icon:`pi pi-sort-${l}-fill`,title:`Mover ${l}`,severity:"secondary",outlined:"",onClick:a=>function(e,l){const a=t.value.indexOf(e),i=o.value.indexOf(e),s=(()=>{if(-1!==a)return t;if(-1!==i)return o;throw new Error("Couldn't find item!")})(),n=s.value.indexOf(e);if("up"===l&&n)s.value.splice(n-1,0,e),s.value.splice(n+1,1);else if("down"===l&&n!==s.value.length-1){const l=s.value.filter((l=>l!==e));l.splice(n+1,0,e),s.value=l}}(e.fileItem,l)},null,8,["icon","title","onClick"]),[[B,!e.isLocationFile]]))),64))])])])])),_:1}))}}),Z=A(Ee,[["__scopeId","data-v-3654535c"]]),Ue={key:0,class:"is-flex is-flex-direction-column is-gap-1"},Ve=L({__name:"GalleryPreview",setup(e){const i=N(),{galleryFiles:s,locationFiles:t}=O(i),o=S(!1);return(e,i)=>a(s).length?(r(),D(a(Q),{key:0,collapsed:o.value,"onUpdate:collapsed":i[1]||(i[1]=e=>o.value=e),header:"Vistra Previa",toggleable:""},{default:b((()=>[m(a(ge),{modelValue:a(s),"onUpdate:modelValue":i[0]||(i[0]=e=>me(s)?s.value=e:null),animation:250,class:"is-flex is-flex-direction-column is-gap-1",handle:".handle"},{default:b((()=>[(r(!0),y(I,null,U(a(s),(e=>(r(),D(Z,{"file-item":e,key:e.id,"is-location-file":!1},null,8,["file-item"])))),128))])),_:1},8,["modelValue"]),a(t).length?(r(),y("div",Ue,[i[2]||(i[2]=l("p",{class:"has-text-weight-bold is-block mb-1"},"Location Files",-1)),(r(!0),y(I,null,U(a(t),(e=>(r(),D(Z,{"file-item":e,key:e.id,"is-location-file":!0},null,8,["file-item"])))),128))])):G("",!0)])),_:1},8,["collapsed"])):G("",!0)}}),ze={class:"is-flex is-flex-direction-column is-gap-2 mt-5"},Ce={key:0,class:"error-message"},Ge={class:"mt-3"},Ne=L({__name:"GalleryInput",setup(e){const i=N(),{galleryFiles:s}=O(i),t=S([]),o=S(!1),n=S("true"===localStorage.getItem("hasSeenInfoModal-Gallery"));let u=0;function c(e){const l=e.files;if(!Array.isArray(l))return;t.value=[];const a=l.filter((e=>e instanceof File&&(!(e.size>E)||(t.value.push(e.name),!1)))).map((e=>({file:e,id:u++,desc:""})));!n.value&&a.length&&(o.value=!0,n.value=!0,localStorage.setItem("hasSeenInfoModal-Gallery","true")),a.length&&s.value.unshift(...a)}const d=S(null),{isOverDropZone:p}=X(d,{onDrop:function(e){if(!e)return;t.value=[];const l=e.filter((e=>!(e.size>E)||(t.value.push(e.name),!1))).map((e=>({file:e,id:u++,desc:""})));!n.value&&l.length&&(o.value=!0,n.value=!0,localStorage.setItem("hasSeenInfoModal-Gallery","true")),l.length&&s.value.unshift(...l)},dataTypes:e=>e.every((e=>e.startsWith("image/"))),multiple:!0,preventDefaultForUnhandled:!0});return(e,i)=>(r(),y("div",ze,[t.value.length?(r(),y("p",Ce,[1===t.value.length?(r(),y(I,{key:0},[i[1]||(i[1]=v(" El archivo ")),l("strong",null,w(t.value[0]),1),i[2]||(i[2]=v(" es demasiado grande para subirlo (máx. 10MB). "))],64)):(r(),y(I,{key:1},[i[3]||(i[3]=v(" Los siguientes archivos son demasiado grandes para subirlos (máx. 10MB): ")),l("ul",null,[(r(!0),y(I,null,U(t.value,(e=>(r(),y("li",{key:e},w(e),1)))),128))])],64)),i[4]||(i[4]=v(" Comprime tu archivo aquí: ")),m(H,{link:"https://nmscd.com/Image-Compressor/",text:"Compresor de imágenes"})])):G("",!0),m(a(q),{maxFileSize:a(E),"show-cancel-button":!1,"show-upload-button":!1,accept:"image/*",auto:"","custom-upload":"",multiple:"",onSelect:c},{header:b((()=>[l("div",{class:"full-width",ref_key:"dropzone",ref:d},[m(a(q),{class:j({"p-button-outlined":!a(p)}),maxFileSize:a(E),accept:"image/*","choose-label":"Añadir archivos",auto:"","custom-upload":"",mode:"basic",multiple:"",onSelect:c},null,8,["class","maxFileSize"])],512)])),empty:b((()=>i[5]||(i[5]=[l("div",{class:"is-flex is-justify-content-center is-align-items-center my-5"},[l("p",null,"Suelte los archivos de la galería aquí")],-1)]))),_:1},8,["maxFileSize"]),m(a(J),{visible:o.value,"onUpdate:visible":i[0]||(i[0]=e=>o.value=e),modal:"",header:"Atención",closable:!0},{default:b((()=>[i[8]||(i[8]=l("span",null,[v(" Las imágenes seleccionadas "),l("strong",null,"no se subirán automáticamente"),v(" a la wiki. Este selector solo agrega las imágenes al formulario actual. ")],-1)),l("div",Ge,[i[6]||(i[6]=v(" Para subir imágenes a la wiki, ve a ")),m(Y,{link:"Special:Upload?multiple=true",text:"Especial:Subir"}),i[7]||(i[7]=v(" y súbelas manualmente. "))]),i[9]||(i[9]=l("div",{class:"mt-3"},[l("span",{class:"has-text-weight-bold"},"NOTA"),v(": Las imágenes agregadas aquí deben el mismo nombre que las que subas a la wiki. Si no, el formulario completará automáticamente el nombre de la imagen incorrectamente. ")],-1))])),_:1,__:[8,9]},8,["visible"]),m(Ve)]))}}),He=A(Ne,[["__scopeId","data-v-8f8c2b8a"]]);export{He as G,Ze as S,Re as _,We as c};
