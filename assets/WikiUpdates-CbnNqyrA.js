"use strict";import{d as j,r,c as V,x as A,a3 as $,j as S,o as n,k as f,b as a,f as u,a as b,t as i,b0 as C,h as c,V as M,X as R,g as d,aV as F,B as H,F as I,J as N,p as T}from"./main-CTaSFn6e.js";import{_ as q}from"./logo-white-CwkOOWqZ.js";import{s as E}from"./index-DYC2jEVN.js";import{s as B}from"./index-C_ry9gUB.js";import{s as P}from"./index-jpphAYd6.js";import{s as J}from"./index-BawlBGxn.js";import"./index-BLKTUcGn.js";const X={class:"space-page-container"},G={class:"flex items-start justify-between mb-6 header-container"},K={class:"flex flex-col"},O={class:"header-container"},Q={class:"title-theme-container"},Y={class:"galactic-title"},Z={class:"title-text"},aa={class:"text-stellar-gray mt-2"},la={class:"text-stellar-gray mt-2"},sa={class:"filter-container mb-6 p-4 bg-space-dark rounded-lg"},ea={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ta={class:"flex"},ia={class:"block mb-2"},oa={class:"panel-content"},ra={class:"update-info mt-2"},na={key:0,class:"loading-message"},ca={key:1,class:"error-message p-error"},da={class:"p-4"},ua={class:"flex flex-column gap-3"},ma={class:"flex align-items-center gap-2"},pa={class:"update-title"},va={class:"update-details"},ga={class:"detail-item"},fa={class:"detail-value"},ba={class:"detail-item"},ha={class:"detail-value"},ka={class:"comment-box mt-3 p-3 bg-space-light rounded"},wa={class:"mt-1"},ya={class:"mt-3"},xa=["href"],_a=["href"],Va=j({__name:"WikiUpdates",setup(Sa){const h=r([]),k=r(!0),m=r(null),w=r(window.innerWidth),p=r(50),v=r(""),o=r(!1),z=V(()=>w.value<768?1:w.value<1200?2:3),L=V(()=>o.value?"https://nomanssky.fandom.com/api.php":"https://nomanssky.fandom.com/es/api.php"),U=r([{value:25,label:"25 resultados"},{value:50,label:"50 resultados"},{value:100,label:"100 resultados"},{value:200,label:"200 resultados"},{value:300,label:"300 resultados"},{value:400,label:"400 resultados"},{value:500,label:"500 resultados"}]),g=async()=>{try{k.value=!0,m.value=null;const t=new URLSearchParams({action:"query",list:"recentchanges",rcprop:"title|timestamp|user|comment|ids|flags|loginfo|revid|old_revid",rclimit:p.value.toString(),rcshow:"!bot",rcdir:"older",format:"json",origin:"*",...v.value&&{rcuser:v.value}}),l=await fetch(`${L.value}?${t.toString()}`);if(!l.ok)throw new Error("Error en la API de la wiki");const s=await l.json();if(s.error)throw new Error(s.error.info);h.value=s.query.recentchanges.map(e=>({title:e.title,timestamp:e.timestamp,user:e.user,comment:e.comment||"(sin comentario)",pageid:e.pageid,revid:e.revid,old_revid:e.old_revid}))}catch(t){m.value="Error al cargar actualizaciones",console.error(t)}finally{k.value=!1}};A(async()=>{window.addEventListener("resize",()=>w.value=window.innerWidth),await g()}),$(o,()=>{g()}),$(p,()=>{g()});const _=t=>t.trim().replace(/\s+/g,"_").replace(/\//g,"_"),D=t=>{const l=new Date,s=new Date(t),e=l.getTime()-s.getTime(),y=Math.floor(e/6e4);if(y<60)return`Hace ${y} min`;const x=Math.floor(y/60);return x<24?`Hace ${x} h`:`Hace ${Math.floor(x/24)} d\xEDas`},W=t=>new Date(t).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return(t,l)=>(n(),S(c(E),{class:"p-0 galactic-card"},{content:f(()=>[a("div",X,[a("div",G,[a("div",K,[l[3]||(l[3]=a("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[a("div",{class:"wiki-logo"},[a("img",{src:q,class:"logo-image",alt:"Wiki Logo"})])],-1)),a("div",O,[a("div",Q,[a("h1",Y,[a("span",Z,"Actualizaciones Recientes - Wiki "+i(o.value?"EN":"ES"),1)])])]),a("p",aa," \xDAltimos cambios en la wiki "+i(o.value?"inglesa":"espa\xF1ola")+" de No Man's Sky ",1)]),a("p",la,[u(C,{style:{"margin-right":"2rem"}})])]),a("div",sa,[a("div",ea,[a("div",null,[l[4]||(l[4]=a("label",{class:"block mb-6 text-stellar-blue font-medium"},"Resultados:",-1)),u(c(J),{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=s=>p.value=s),options:U.value,optionLabel:"label",optionValue:"value",class:"w-full ml-2",pt:{root:{class:"bg-space-light border-space-blue"},input:{class:"text-stellar-light"},trigger:{class:"bg-space-blue"}}},null,8,["modelValue","options"])]),a("div",null,[l[5]||(l[5]=a("label",{class:"block mb-2"},"Filtrar por usuario:",-1)),a("div",ta,[u(c(M),{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=s=>v.value=s),placeholder:"Nombre de usuario",class:"w-full"},null,8,["modelValue"]),a("button",{onClick:g,class:"p-button p-component ml-2"}," Buscar ")])])]),a("div",null,[a("label",ia,[R(a("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=s=>o.value=s),class:"mr-2"},null,512),[[F,o.value]]),l[6]||(l[6]=d(" Consultar wiki en ingl\xE9s "))])])]),u(c(P),{class:"galactic-panel"},{header:f(()=>l[7]||(l[7]=[a("h2",{class:"panel-title"},"Informaci\xF3n de Actualizaciones",-1)])),default:f(()=>[a("div",oa,[a("p",null,[l[8]||(l[8]=d(" Total de cambios recientes: ")),a("strong",null,i(h.value.length),1)]),a("p",ra,"Actualizado: "+i(new Date().toLocaleString("es-ES")),1)])]),_:1}),l[17]||(l[17]=a("br",null,null,-1)),k.value?(n(),b("div",na,l[9]||(l[9]=[a("i",{class:"pi pi-spinner pi-spin"},null,-1),d(" Cargando actualizaciones... ")]))):m.value?(n(),b("div",ca,[l[10]||(l[10]=a("i",{class:"pi pi-exclamation-triangle"},null,-1)),d(" "+i(m.value),1)])):(n(),b("div",{key:2,class:"grid gap-4",style:H(`grid-template-columns: repeat(${z.value}, 1fr)`)},[(n(!0),b(I,null,N(h.value,(s,e)=>(n(),S(c(E),{key:e,class:"update-card"},{content:f(()=>[a("div",da,[a("div",ua,[a("div",ma,[a("h3",pa,i(s.title),1),u(c(B),{value:D(s.timestamp),severity:"info",class:"time-tag"},null,8,["value"])]),a("div",va,[a("div",ga,[l[11]||(l[11]=a("span",{class:"detail-label"},"Usuario:",-1)),a("span",fa,i(s.user),1)]),a("div",ba,[l[12]||(l[12]=a("span",{class:"detail-label"},"Fecha:",-1)),a("span",ha,i(W(s.timestamp)),1)]),a("div",ka,[l[13]||(l[13]=a("span",{class:"detail-label"},"Comentario:",-1)),a("p",wa,i(s.comment),1)])]),a("div",ya,[a("a",{href:`https://nomanssky.fandom.com/${o.value?"":"es/"}wiki/${_(s.title)}`,target:"_blank",class:"wiki-link"},l[14]||(l[14]=[a("i",{class:"pi pi-external-link"},null,-1),d(" Ver p\xE1gina en la wiki ")]),8,xa),l[16]||(l[16]=a("span",{class:"mx-2"},"|",-1)),a("a",{href:`https://nomanssky.fandom.com/${o.value?"":"es/"}wiki/${_(s.title)}?diff=${s.revid}&oldid=${s.old_revid}`,target:"_blank",class:"wiki-link"},l[15]||(l[15]=[a("i",{class:"pi pi-history"},null,-1),d(" Ver cambios ")]),8,_a)])])])]),_:2},1024))),128))],4))])]),_:1}))}}),$a=T(Va,[["__scopeId","data-v-b749a47c"]]);export{$a as default};
