import{_ as N,s as m}from"./index-DmWp1Jx8.js";import{s as h}from"./index-Bgqte2SC.js";import{s as S}from"./index-Dx00KFQF.js";import{d as R,r as g,c as D,a2 as P,j as w,o as c,k as u,b as e,a as f,f as d,h as o,a3 as B,g as v,t as p,a4 as $,F as I,a0 as E,e as L,p as V}from"./main-CYOZSl3i.js";const A="https://nomanssky.fandom.com/api.php",T=e=>{const a=new URLSearchParams;return Object.entries(e).forEach((([e,s])=>{a.append(e,s.toString())})),`${A}?${a.toString()}`},j={format:"json",origin:"*"},F=(e,a,s)=>{const l={...j,action:"cargoquery",tables:"Bases",fields:["Name","CensusPlayer","CensusReddit","CensusDiscord","CensusFriend","System","Platform","Mode","CensusArrival","CensusRenewal","Builderlink"].join(","),where:`CensusShow IS NOT NULL AND Civilized='${e}'${s?` AND CensusRenewal HOLDS ${s}`:""}`,order_by:"CensusRenewal DESC",group_by:"CensusPlayer",limit:500,offset:a};return T(l)},O=async e=>{try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.text(),l=q(s);return JSON.parse(l)}catch(e){throw console.error("API call failed:",e),e}},q=e=>e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"),M=e=>e.cargoquery.map((({title:e})=>({Name:e.Name,CensusPlayer:e.CensusPlayer,System:e.System,Platform:e.Platform,Mode:e.Mode,CensusArrival:e.CensusArrival,CensusRenewal:e.CensusRenewal,Builderlink:e.Builderlink,CensusReddit:e.CensusReddit,CensusDiscord:e.CensusDiscord,CensusFriend:e.CensusFriend,CensusVerified:e.CensusVerified}))),U=async(e,a,s)=>{const l=F(e,a,s),t=await O(l);if(null==t||!t.cargoquery)throw new Error("Invalid API response structure");return M(t)},z={class:"space-page-container"},H={class:"filter-container mb-4 flex items-center"},Q={key:0,class:"loading-message"},W={key:1,class:"error-message p-error"},J={class:"p-4 base-content"},Y={class:"flex flex-column gap-3"},Z={class:"flex align-items-center gap-2"},G={class:"base-title"},K={class:"base-details"},X={class:"detail-item"},ee={class:"detail-value"},se={class:"detail-item"},ae={class:"detail-value"},te={class:"flex gap-2"},le=["href"],ne={class:"panel-content"},re={class:"security-level mt-2"},oe={class:"update-info"},ie="Royal Space Society",ce=R({__name:"CensusTable",setup(a){const s=g([]),l=g(!0),t=g(null),n=g(window.innerWidth),i=g(""),r=D((()=>n.value<768?1:n.value<1200?2:3)),y=async(e=0,a)=>{try{const l=await U(ie,e,a);s.value=[...s.value,...l],500===l.length&&await y(e+500,a)}catch(e){t.value="Error al cargar las bases",console.log(e)}finally{l.value=!1}},C=async()=>{s.value=[],l.value=!0,t.value=null,await y(0,i.value)};return P((async()=>{window.addEventListener("resize",(()=>n.value=window.innerWidth)),await y(0,i.value)})),(a,n)=>(c(),w(o(h),{class:"p-0 galactic-card"},{content:u((()=>[e("div",z,[n[11]||(n[11]=e("div",{class:"flex items-start justify-between mb-6 header-container"},[e("div",{class:"flex flex-col"},[e("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[e("div",{class:"rss-logo"},[e("img",{src:N,class:"logo-image",alt:"RSS Logo"})])]),e("div",{class:"header-container"},[e("div",{class:"title-theme-container"},[e("h1",{class:"galactic-title"},[e("span",{class:"title-text"},"Censo de Bases - Royal Space Society")])])]),e("p",{class:"text-stellar-gray mt-2"},"Explora las bases espaciales de la Royal Space Society")])],-1)),e("div",H,[n[1]||(n[1]=e("label",{for:"yearInput",class:"mr-2"},"Selecciona el año del censo:",-1)),d(o(B),{id:"yearInput",type:"number",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),placeholder:"Ej. 2023",class:"p-inputtext"},null,8,["modelValue"]),e("button",{onClick:C,class:"p-button p-component ml-2"},"Filtrar")]),l.value?(c(),f("div",Q,n[2]||(n[2]=[e("i",{class:"pi pi-spinner pi-spin"},null,-1),v(" Cargando bases espaciales... ")]))):t.value?(c(),f("div",W,[n[3]||(n[3]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),v(" "+p(t.value),1)])):(c(),f("div",{key:2,class:"grid gap-4",style:$(`grid-template-columns: repeat(${r.value}, 1fr)`)},[(c(!0),f(I,null,E(s.value,((a,s)=>(c(),w(o(h),{key:s,class:"link-card"},{content:u((()=>[e("div",J,[e("div",Y,[e("div",Z,[e("h3",G,p(a.Name),1),d(o(m),{value:a.Platform,severity:"info",class:"category-tag"},null,8,["value"])]),e("div",K,[e("div",X,[n[4]||(n[4]=e("span",{class:"detail-label"},"Jugador:",-1)),e("span",ee,p(a.CensusPlayer),1)]),e("div",se,[n[5]||(n[5]=e("span",{class:"detail-label"},"Sistema:",-1)),e("span",ae,p(a.System),1)]),e("div",te,[d(o(m),{value:a.Mode,severity:"success",class:"category-tag"},null,8,["value"]),d(o(m),{value:`Llegada: ${a.CensusArrival}`,severity:"warning",class:"category-tag"},null,8,["value"]),d(o(m),{value:`Renovación: ${a.CensusRenewal}`,severity:"danger",class:"category-tag"},null,8,["value"])])]),a.Name?(c(),w(o(S),{key:0,class:"builder-panel mt-3"},{header:u((()=>n[6]||(n[6]=[e("span",{class:"builder-link-header"},"Enlaces de la Base",-1)]))),default:u((()=>[e("a",{href:`https://nomanssky.fandom.com/wiki/${a.Name}`,target:"_blank",class:"builder-link"},n[7]||(n[7]=[e("i",{class:"pi pi-external-link"},null,-1),v(" Ver detalles de construcción ")]),8,le)])),_:2},1024)):L("",!0)])])])),_:2},1024)))),128))],4)),d(o(S),{class:"galactic-panel mt-6"},{header:u((()=>n[8]||(n[8]=[e("h2",{class:"panel-title"},"Información del Censo",-1)]))),default:u((()=>[e("div",ne,[e("p",null,[n[9]||(n[9]=v("Total de bases registradas: ")),e("strong",null,p(s.value.length),1)]),e("p",re,[n[10]||(n[10]=v(" Nivel de seguridad: ")),d(o(m),{value:"Clasificado RSS",severity:"info",class:"category-tag"})]),e("p",oe,"Última actualización: "+p((new Date).toLocaleDateString()),1)])])),_:1})])])),_:1}))}}),ge=V(ce,[["__scopeId","data-v-1f0ab95c"]]);export{ge as default};
