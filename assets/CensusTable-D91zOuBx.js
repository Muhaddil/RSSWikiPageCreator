import{_ as N,s as g}from"./index-BO4unG1j.js";import{s as h}from"./index-BNAXJ4FM.js";import{s as S}from"./index-Dgfd8v5Y.js";import{d as R,r as v,c as P,a2 as B,j as w,o as c,k as u,b as e,f as d,a as C,h as r,a3 as $,g as y,t as p,a4 as I,F as L,a0 as E,e as V,p as A}from"./main-CdllbLEQ.js";const T="https://nomanssky.fandom.com/api.php",j=e=>{const a=new URLSearchParams;return Object.entries(e).forEach((([e,s])=>{a.append(e,s.toString())})),`${T}?${a.toString()}`},F={format:"json",origin:"*"},O=(e,a,s)=>{const l={...F,action:"cargoquery",tables:"Bases",fields:["Name","CensusPlayer","CensusReddit","CensusDiscord","CensusFriend","System","Platform","Mode","CensusArrival","CensusRenewal","Builderlink"].join(","),where:`CensusShow IS NOT NULL AND Civilized='${e}'${s?` AND CensusRenewal HOLDS ${s}`:""}`,order_by:"CensusRenewal DESC",group_by:"CensusPlayer",limit:500,offset:a};return console.log(l),j(l)},q=async e=>{try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.text(),l=M(s);return JSON.parse(l)}catch(e){throw console.error("API call failed:",e),e}},M=e=>e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"),U=e=>e.cargoquery.map((({title:e})=>({Name:e.Name,_pageName:e._pageName||e.Name,CensusPlayer:e.CensusPlayer||"Desconocido",System:e.System||"Desconocido",Platform:e.Platform||"Desconocida",Mode:e.Mode||"Desconocido",CensusArrival:e.CensusArrival||"Desconocido",CensusRenewal:e.CensusRenewal||"Desconocido",Builderlink:e.Builderlink,CensusReddit:e.CensusReddit,CensusDiscord:e.CensusDiscord,CensusFriend:e.CensusFriend,CensusVerified:e.CensusVerified}))),z=async(e,a,s)=>{const l=O(e,a,s),n=await q(l);if(null==n||!n.cargoquery)throw new Error("Invalid API response structure");return U(n)},W={class:"space-page-container"},H={class:"filter-container mb-4 flex items-center"},Q={class:"panel-content"},J={class:"security-level mt-2"},Y={class:"update-info"},Z={key:0,class:"loading-message"},G={key:1,class:"error-message p-error"},K={class:"p-4 base-content"},X={class:"flex flex-column gap-3"},ee={class:"flex align-items-center gap-2"},se={class:"base-title"},ae={class:"base-details"},te={class:"detail-item"},le={class:"detail-value"},ne={class:"detail-item"},oe={class:"detail-value"},re={class:"flex gap-2"},ie=["href"],ce="Royal Space Society",de=R({__name:"CensusTable",setup(a){const s=v([]),l=v(!0),n=v(null),t=v(window.innerWidth),i=v(""),o=P((()=>t.value<768?1:t.value<1200?2:3)),m=async(e=0,a)=>{try{const l=await z(ce,e,a);s.value=[...s.value,...l],500===l.length&&await m(e+500,a)}catch(e){n.value="Error al cargar las bases",console.log(e)}finally{l.value=!1}},f=async()=>{s.value=[],l.value=!0,n.value=null,await m(0,i.value)};B((async()=>{window.addEventListener("resize",(()=>t.value=window.innerWidth)),await m(0,i.value)}));const b=e=>e.trim().replace(/\s+/g,"_").replace(/\//g,"_").replace(/:/g,":").replace(/'/g,"'");return(a,t)=>(c(),w(r(h),{class:"p-0 galactic-card"},{content:u((()=>[e("div",W,[t[11]||(t[11]=e("div",{class:"flex items-start justify-between mb-6 header-container"},[e("div",{class:"flex flex-col"},[e("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[e("div",{class:"rss-logo"},[e("img",{src:N,class:"logo-image",alt:"RSS Logo"})])]),e("div",{class:"header-container"},[e("div",{class:"title-theme-container"},[e("h1",{class:"galactic-title"},[e("span",{class:"title-text"},"Censo de Bases - Royal Space Society")])])]),e("p",{class:"text-stellar-gray mt-2"},"Explora las bases espaciales de la Royal Space Society")])],-1)),e("div",H,[t[1]||(t[1]=e("label",{for:"yearInput",class:"mr-2"},"Selecciona el año del censo:",-1)),d(r($),{id:"yearInput",type:"number",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),placeholder:"Ej. 2023",class:"p-inputtext"},null,8,["modelValue"]),e("button",{onClick:f,class:"p-button p-component ml-2"},"Filtrar")]),d(r(S),{class:"galactic-panel mt-6"},{header:u((()=>t[2]||(t[2]=[e("h2",{class:"panel-title"},"Información del Censo",-1)]))),default:u((()=>[e("div",Q,[e("p",null,[t[3]||(t[3]=y("Total de bases registradas: ")),e("strong",null,p(s.value.length),1)]),e("p",J,[t[4]||(t[4]=y(" Nivel de seguridad: ")),d(r(g),{value:"Clasificado RSS",severity:"info",class:"category-tag"})]),e("p",Y,"Última actualización: "+p((new Date).toLocaleDateString()),1)])])),_:1}),t[12]||(t[12]=e("br",null,null,-1)),l.value?(c(),C("div",Z,t[5]||(t[5]=[e("i",{class:"pi pi-spinner pi-spin"},null,-1),y(" Cargando bases espaciales... ")]))):n.value?(c(),C("div",G,[t[6]||(t[6]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),y(" "+p(n.value),1)])):(c(),C("div",{key:2,class:"grid gap-4",style:I(`grid-template-columns: repeat(${o.value}, 1fr)`)},[(c(!0),C(L,null,E(s.value,((a,s)=>(c(),w(r(h),{key:s,class:"link-card"},{content:u((()=>[e("div",K,[e("div",X,[e("div",ee,[e("h3",se,p(a.Name),1),d(r(g),{value:a.Platform,severity:"info",class:"category-tag"},null,8,["value"])]),e("div",ae,[e("div",te,[t[7]||(t[7]=e("span",{class:"detail-label"},"Jugador:",-1)),e("span",le,p(a.CensusPlayer),1)]),e("div",ne,[t[8]||(t[8]=e("span",{class:"detail-label"},"Sistema:",-1)),e("span",oe,p(a.System),1)]),e("div",re,[d(r(g),{value:a.Mode,severity:"success",class:"category-tag"},null,8,["value"]),d(r(g),{value:`Llegada: ${a.CensusArrival}`,severity:"warning",class:"category-tag"},null,8,["value"]),d(r(g),{value:`Renovación: ${a.CensusRenewal}`,severity:"danger",class:"category-tag"},null,8,["value"])])]),a.Name?(c(),w(r(S),{key:0,class:"builder-panel mt-3"},{header:u((()=>t[9]||(t[9]=[e("span",{class:"builder-link-header"},"Enlaces de la Base",-1)]))),default:u((()=>[e("a",{href:`https://nomanssky.fandom.com/wiki/${b(a._pageName)}`,target:"_blank",class:"builder-link"},t[10]||(t[10]=[e("i",{class:"pi pi-external-link"},null,-1),y(" Ver detalles de construcción ")]),8,ie)])),_:2},1024)):V("",!0)])])])),_:2},1024)))),128))],4))])])),_:1}))}}),ve=A(de,[["__scopeId","data-v-7d4b0f88"]]);export{ve as default};
