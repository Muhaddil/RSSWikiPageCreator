import{d as B,r as n,c as $,x as D,a3 as V,j as S,o as r,k as f,b as s,f as u,a as _,t as o,b0 as M,h as d,V as N,X as R,g as c,aV as T,B as A,F as j,J as F,p as H}from"./main-CUdmV-Wl.js";import{_ as I}from"./logo-white-CwkOOWqZ.js";import{s as E}from"./index-CfaTqabV.js";import{s as q}from"./index-BZeyvkUj.js";import{s as P}from"./index-j2ji1kaQ.js";import{s as J}from"./index-CuHFueRE.js";import"./index-BSGj8d_z.js";const O={class:"space-page-container"},X={class:"flex items-start justify-between mb-6 header-container"},G={class:"flex flex-col"},K={class:"header-container"},Q={class:"title-theme-container"},Y={class:"galactic-title"},Z={class:"title-text"},ss={class:"text-stellar-gray mt-2"},es={class:"text-stellar-gray mt-2"},ts={class:"filter-container mb-6 p-4 bg-space-dark rounded-lg"},as={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ls={class:"flex"},os={class:"block mb-2"},is={class:"panel-content"},ns={class:"update-info mt-2"},rs={key:0,class:"loading-message"},ds={key:1,class:"error-message p-error"},cs={class:"p-4"},us={class:"flex flex-column gap-3"},ms={class:"flex align-items-center gap-2"},ps={class:"update-title"},vs={class:"update-details"},gs={class:"detail-item"},fs={class:"detail-value"},_s={class:"detail-item"},bs={class:"detail-value"},hs={class:"comment-box mt-3 p-3 bg-space-light rounded"},ks={class:"mt-1"},ws={class:"mt-3"},ys=["href"],xs=["href"],$s=B({__name:"WikiUpdates",setup(Vs){const b=n([]),h=n(!0),m=n(null),k=n(window.innerWidth),p=n(50),v=n(""),i=n(!1),U=$(()=>k.value<768?1:k.value<1200?2:3),L=$(()=>i.value?"https://nomanssky.fandom.com/api.php":"https://nomanssky.fandom.com/es/api.php"),W=n([{value:25,label:"25 resultados"},{value:50,label:"50 resultados"},{value:100,label:"100 resultados"},{value:200,label:"200 resultados"},{value:300,label:"300 resultados"},{value:400,label:"400 resultados"},{value:500,label:"500 resultados"}]),g=async()=>{try{h.value=!0,m.value=null;const l=new URLSearchParams({action:"query",list:"recentchanges",rcprop:"title|timestamp|user|comment|ids|flags|loginfo|revid|old_revid",rclimit:p.value.toString(),rcshow:"!bot",rcdir:"older",format:"json",origin:"*",...v.value&&{rcuser:v.value}}),e=await fetch(`${L.value}?${l.toString()}`);if(!e.ok)throw new Error("Error en la API de la wiki");const t=await e.json();if(t.error)throw new Error(t.error.info);b.value=t.query.recentchanges.map(a=>({title:a.title,timestamp:a.timestamp,user:a.user,comment:a.comment||"(sin comentario)",pageid:a.pageid,revid:a.revid,old_revid:a.old_revid}))}catch(l){m.value="Error al cargar actualizaciones",console.error(l)}finally{h.value=!1}};D(async()=>{window.addEventListener("resize",()=>k.value=window.innerWidth),await g()}),V(i,()=>{g()}),V(p,()=>{g()});const x=l=>l.trim().replace(/\s+/g,"_").replace(/\//g,"_"),C=l=>{const e=new Date,t=new Date(l),a=e.getTime()-t.getTime(),w=Math.floor(a/6e4);if(w<60)return`Hace ${w} min`;const y=Math.floor(w/60);return y<24?`Hace ${y} h`:`Hace ${Math.floor(y/24)} días`},z=l=>new Date(l).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return(l,e)=>(r(),S(d(E),{class:"p-0 galactic-card"},{content:f(()=>[s("div",O,[s("div",X,[s("div",G,[e[3]||(e[3]=s("a",{href:"https://nomanssky.fandom.com/es/wiki/Royal_Space_Society",target:"_blank"},[s("div",{class:"wiki-logo"},[s("img",{src:I,class:"logo-image",alt:"Wiki Logo"})])],-1)),s("div",K,[s("div",Q,[s("h1",Y,[s("span",Z,"Actualizaciones Recientes - Wiki "+o(i.value?"EN":"ES"),1)])])]),s("p",ss," Últimos cambios en la wiki "+o(i.value?"inglesa":"española")+" de No Man's Sky ",1)]),s("p",es,[u(M,{style:{"margin-right":"2rem"}})])]),s("div",ts,[s("div",as,[s("div",null,[e[4]||(e[4]=s("label",{class:"block mb-6 text-stellar-blue font-medium"},"Resultados:",-1)),u(d(J),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),options:W.value,optionLabel:"label",optionValue:"value",class:"w-full ml-2",pt:{root:{class:"bg-space-light border-space-blue"},input:{class:"text-stellar-light"},trigger:{class:"bg-space-blue"}}},null,8,["modelValue","options"])]),s("div",null,[e[5]||(e[5]=s("label",{class:"block mb-2"},"Filtrar por usuario:",-1)),s("div",ls,[u(d(N),{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),placeholder:"Nombre de usuario",class:"w-full"},null,8,["modelValue"]),s("button",{onClick:g,class:"p-button p-component ml-2"}," Buscar ")])])]),s("div",null,[s("label",os,[R(s("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),class:"mr-2"},null,512),[[T,i.value]]),e[6]||(e[6]=c(" Consultar wiki en inglés "))])])]),u(d(P),{class:"galactic-panel"},{header:f(()=>e[7]||(e[7]=[s("h2",{class:"panel-title"},"Información de Actualizaciones",-1)])),default:f(()=>[s("div",is,[s("p",null,[e[8]||(e[8]=c(" Total de cambios recientes: ")),s("strong",null,o(b.value.length),1)]),s("p",ns,"Actualizado: "+o(new Date().toLocaleString("es-ES")),1)])]),_:1}),e[17]||(e[17]=s("br",null,null,-1)),h.value?(r(),_("div",rs,e[9]||(e[9]=[s("i",{class:"pi pi-spinner pi-spin"},null,-1),c(" Cargando actualizaciones... ")]))):m.value?(r(),_("div",ds,[e[10]||(e[10]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),c(" "+o(m.value),1)])):(r(),_("div",{key:2,class:"grid gap-4",style:A(`grid-template-columns: repeat(${U.value}, 1fr)`)},[(r(!0),_(j,null,F(b.value,(t,a)=>(r(),S(d(E),{key:a,class:"update-card"},{content:f(()=>[s("div",cs,[s("div",us,[s("div",ms,[s("h3",ps,o(t.title),1),u(d(q),{value:C(t.timestamp),severity:"info",class:"time-tag"},null,8,["value"])]),s("div",vs,[s("div",gs,[e[11]||(e[11]=s("span",{class:"detail-label"},"Usuario:",-1)),s("span",fs,o(t.user),1)]),s("div",_s,[e[12]||(e[12]=s("span",{class:"detail-label"},"Fecha:",-1)),s("span",bs,o(z(t.timestamp)),1)]),s("div",hs,[e[13]||(e[13]=s("span",{class:"detail-label"},"Comentario:",-1)),s("p",ks,o(t.comment),1)])]),s("div",ws,[s("a",{href:`https://nomanssky.fandom.com/${i.value?"":"es/"}wiki/${x(t.title)}`,target:"_blank",class:"wiki-link"},e[14]||(e[14]=[s("i",{class:"pi pi-external-link"},null,-1),c(" Ver página en la wiki ")]),8,ys),e[16]||(e[16]=s("span",{class:"mx-2"},"|",-1)),s("a",{href:`https://nomanssky.fandom.com/${i.value?"":"es/"}wiki/${x(t.title)}?diff=${t.revid}&oldid=${t.old_revid}`,target:"_blank",class:"wiki-link"},e[15]||(e[15]=[s("i",{class:"pi pi-history"},null,-1),c(" Ver cambios ")]),8,xs)])])])]),_:2},1024))),128))],4))])]),_:1}))}}),Ds=H($s,[["__scopeId","data-v-b749a47c"]]);export{Ds as default};
