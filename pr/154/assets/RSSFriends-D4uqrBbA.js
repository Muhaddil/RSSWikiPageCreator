import{l as I,r as $,s as A,b as F,p as U}from"./primevue-BrRcJYPX.js";import{_ as j}from"./FileUploadNotice.vue_vue_type_script_setup_true_lang-rFb_oe5w.js";import{_ as C,g as L,b as T}from"./main-wGEXJ2ns.js";import{h as B}from"./html2canvas-pro-96BRS6AZ.js";import{r as M}from"./inputValidation-BfiqxGfe.js";import{d as G}from"./debounce-B7UkYTDg.js";import{Y as K,r as o,o as q,_ as J,v as O,c as R,b as d,J as y,L as c,K as m,d as a,O as n,x as u,M as h,F as g,E as Z,Q,n as Y}from"./@vue-BVuy3UwB.js";import{w as H}from"./@vueuse-mn-U9ctI.js";import"./@primevue-CYWj3w9m.js";import"./@primeuix-B0kugbDQ.js";import"./pinia-CGu4iIBQ.js";import"./parse-mediawiki-template--QNsUU1W.js";import"./vue-toastification-Cd_xC2xJ.js";const X="/RSSWikiPageCreator/assets/images/friends/marco.png",ee={class:"upload-section"},ae={class:"columns is-mobile mb-0"},le={class:"column is-flex"},se={class:"columns is-mobile mb-0"},oe={class:"column is-flex"},te={ref:"cardElement",class:"rss-card-wrapper"},ne=["src"],ie={class:"card-image-container"},re=["src"],de={class:"card-race-icon-field"},ue=["src"],ce={class:"download-section"},me=K({__name:"RSSFriends",setup(e){const l=o(""),s=o(""),i=o(""),t=o(""),r=o(""),v=o(""),p=o(1),b=o(!1),f=o([{label:"Korvax",value:"Korvax",icon:"/RSSWikiPageCreator/assets/images/friends/holo-korvax.png"},{label:"Gek",value:"Gek",icon:"/RSSWikiPageCreator/assets/images/friends/holo-gek.png"},{label:"Vy'keen",value:"Vy'keen",icon:"/RSSWikiPageCreator/assets/images/friends/holo-vykeen.png"},{label:"Anomalía",value:"Anomalía",icon:"/RSSWikiPageCreator/assets/images/friends/holo-anomalia.png"},{label:"Autofago",value:"Autofago",icon:"/RSSWikiPageCreator/assets/images/friends/holo-autofago.png"},{label:"Viajero",value:"Viajero",icon:"/RSSWikiPageCreator/assets/images/friends/holo-viajero.png"}]),w=e=>{const a=e.files[0];if(a){const e=new FileReader;e.onload=e=>{var a;r.value=null==(a=e.target)?void 0:a.result},e.readAsDataURL(a)}},k=o(window.innerWidth);let x=null;const S=()=>{const e=window.innerWidth;Math.abs(e-k.value)>50&&(x&&clearTimeout(x),x=setTimeout((()=>{k.value=e}),500))};q((()=>{window.addEventListener("resize",S)})),J((()=>{window.removeEventListener("resize",S)}));const V=()=>{const e=f.value.find((e=>e.value===s.value));i.value=e?e.icon:""},_=async()=>{const e=document.querySelector(".rss-card-wrapper");if(!e)return;await Y();const a=e.getBoundingClientRect();b.value=!0;try{requestAnimationFrame((async()=>{try{const l=(await B(e,{scale:p.value||1,backgroundColor:null,useCORS:!0,width:a.width,height:a.height,logging:!1})).toDataURL("image/png");E(l)}catch(e){console.error("Error al generar la imagen:",e)}finally{b.value=!1}}))}catch(e){console.error("Error al descargar la imagen:",e),b.value=!1}},E=e=>{const a=document.createElement("a");a.href=e,a.download="tarjeta.png",document.body.appendChild(a),a.click(),document.body.removeChild(a)};O((()=>t.value=t.value.toUpperCase()));const W=o(!0);return H(t,(e=>{const a=new RegExp(/(?:[0-9A-Za-z]{4}-){2}[0-9A-Za-z]{5}/),l=M(e,a);W.value=!e||l}),{debounce:G}),(e,o)=>(d(),R(Q,null,[k.value>768?(d(),y(u(U),{key:0,class:"rss-card-container"},{content:m((()=>[a("div",ee,[a("div",ae,[o[5]||(o[5]=a("div",{class:"column is-flex is-align-items-center"},[a("label",null,"¿En blanco?")],-1)),a("div",le,[n(u(I),{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=e=>v.value=e),"true-value":"true","false-value":"",class:"input-text",style:{width:"185px",left:"-12px"},binary:""},null,8,["modelValue"])])]),n(C,{"model-value":p.value.toString(),"onUpdate:modelValue":o[1]||(o[1]=e=>p.value=Math.min(Number(e)||1,10)),placeholder:"Número",class:"input-text",label:"Escala de salida de la foto",tooltip:"La escala máxima es 10"},null,8,["model-value"]),n(C,{modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=e=>l.value=e),placeholder:"Nombre",class:"input-text",label:"Nombre del jugador"},null,8,["modelValue"]),a("div",se,[o[6]||(o[6]=a("div",{class:"column is-flex is-align-items-center"},[a("label",null,"Raza del Jugador")],-1)),a("div",oe,[n(L,{modelValue:s.value,"onUpdate:modelValue":[o[3]||(o[3]=e=>s.value=e),V],options:f.value.map((e=>e.value)),class:"input-text",style:{width:"185px",left:"-12px"}},null,8,["modelValue","options"])])]),n(C,{modelValue:t.value,"onUpdate:modelValue":o[4]||(o[4]=e=>t.value=e),placeholder:"Código de amigo",class:"input-text",label:"Código de amigo",invalid:!W.value,"error-message":"Formato de código de amigo incorrecto"},null,8,["modelValue","invalid"]),o[7]||(o[7]=a("br",null,null,-1)),n(u($),{mode:"basic",name:"navImage",auto:!0,customUpload:!0,onUploader:w,accept:"image/*",chooseLabel:"Subir imagen"},{content:m((()=>[n(j)])),_:1})]),o[11]||(o[11]=a("br",null,null,-1)),a("div",te,[a("img",{class:"rss-card-background",src:v.value?`/RSSWikiPageCreator/assets/images/friends/friend-white.png?${Date.now()}`:`/RSSWikiPageCreator/assets/images/friends/friend.png?${Date.now()}`,alt:"Tarjeta RSS"},null,8,ne),a("div",ie,[r.value?(d(),R("img",{key:0,src:r.value,alt:"Imagen subida",class:"uploaded-image"},null,8,re)):c("",!0)]),o[8]||(o[8]=a("div",{class:"card-name-title"}," Nombre ",-1)),o[9]||(o[9]=a("div",{class:"card-race-title"}," Raza ",-1)),o[10]||(o[10]=a("img",{class:"card-image-marco",src:X,alt:"Tarjeta RSS"},null,-1)),a("div",{class:h(["card-name-field",{"text-black":v.value,"text-white":!v.value}])},g(l.value),3),a("div",{class:h(["card-race-field",{"text-black":v.value,"text-white":!v.value}])},g(s.value),3),a("div",{class:h(["card-friend-code-field",{"text-black":v.value,"text-white":!v.value}])},g(t.value),3),a("div",de,[i.value?(d(),R("img",{key:0,src:i.value,alt:"Icono de raza",class:"race-icon"},null,8,ue)):c("",!0)])],512),o[12]||(o[12]=a("br",null,null,-1)),a("div",ce,[n(u(A),{onClick:_,class:"download-button",disabled:b.value,loading:b.value,style:{color:"white"}},{icon:m((()=>[b.value?(d(),y(u(F),{key:0,class:"pi pi-spin pi-spinner"})):c("",!0)])),default:m((()=>[Z(" "+g(b.value?"Generando imagen...":"Descargar Carta"),1)])),_:1},8,["disabled","loading"])]),o[13]||(o[13]=a("br",null,null,-1)),o[14]||(o[14]=a("br",null,null,-1)),o[15]||(o[15]=a("br",null,null,-1)),o[16]||(o[16]=a("h2",null,[a("i",null,"Imágenes creadas por paux1926.")],-1))])),_:1})):c("",!0),k.value<=768?(d(),y(u(U),{key:1,class:"rss-card-container"},{content:m((()=>o[17]||(o[17]=[a("h1",null,"Esta página solo está disponible en pantallas de escritorio.",-1)]))),_:1})):c("",!0)],64))}}),Ee=T(me,[["__scopeId","data-v-534ca238"]]);export{Ee as default};
